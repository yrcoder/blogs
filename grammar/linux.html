<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>shell | YRcoder</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/blogs/assets/css/0.styles.49137356.css" as="style"><link rel="preload" href="/blogs/assets/js/app.2b612f2a.js" as="script"><link rel="preload" href="/blogs/assets/js/14.ca8ee814.js" as="script"><link rel="prefetch" href="/blogs/assets/js/19.32209c0d.js"><link rel="prefetch" href="/blogs/assets/js/2.d8d0300f.js"><link rel="prefetch" href="/blogs/assets/js/3.78bce9f9.js"><link rel="prefetch" href="/blogs/assets/js/4.a3a81660.js"><link rel="prefetch" href="/blogs/assets/js/5.43029159.js"><link rel="prefetch" href="/blogs/assets/js/6.875575e2.js"><link rel="prefetch" href="/blogs/assets/js/7.c9ffc06c.js"><link rel="prefetch" href="/blogs/assets/js/8.93c6ec89.js"><link rel="prefetch" href="/blogs/assets/js/9.84e0ec54.js"><link rel="prefetch" href="/blogs/assets/js/10.db99257f.js"><link rel="prefetch" href="/blogs/assets/js/11.687313e6.js"><link rel="prefetch" href="/blogs/assets/js/12.28f8784f.js"><link rel="prefetch" href="/blogs/assets/js/13.0b2e299e.js"><link rel="prefetch" href="/blogs/assets/js/15.043efc1f.js"><link rel="prefetch" href="/blogs/assets/js/16.9a7002c8.js"><link rel="prefetch" href="/blogs/assets/js/17.e74890e2.js"><link rel="prefetch" href="/blogs/assets/js/18.faaea426.js"><link rel="prefetch" href="/blogs/assets/js/20.fce76639.js"><link rel="prefetch" href="/blogs/assets/js/21.1ac604c1.js"><link rel="prefetch" href="/blogs/assets/js/22.5cc26646.js"><link rel="prefetch" href="/blogs/assets/js/23.26b6189b.js"><link rel="prefetch" href="/blogs/assets/js/24.243fe967.js"><link rel="prefetch" href="/blogs/assets/js/25.00d13d8e.js"><link rel="prefetch" href="/blogs/assets/js/26.9793daa6.js"><link rel="prefetch" href="/blogs/assets/js/27.5e040fb5.js"><link rel="prefetch" href="/blogs/assets/js/28.eac84346.js"><link rel="prefetch" href="/blogs/assets/js/29.ac1518e6.js"><link rel="prefetch" href="/blogs/assets/js/30.cb0249c5.js"><link rel="prefetch" href="/blogs/assets/js/31.1f406963.js"><link rel="prefetch" href="/blogs/assets/js/32.27c448e1.js"><link rel="prefetch" href="/blogs/assets/js/33.66d1b1d4.js"><link rel="prefetch" href="/blogs/assets/js/34.8f89af58.js"><link rel="prefetch" href="/blogs/assets/js/35.95d09688.js"><link rel="prefetch" href="/blogs/assets/js/36.0cdd6acb.js"><link rel="prefetch" href="/blogs/assets/js/37.f7075148.js"><link rel="prefetch" href="/blogs/assets/js/38.13ffb522.js"><link rel="prefetch" href="/blogs/assets/js/39.4edced61.js"><link rel="prefetch" href="/blogs/assets/js/40.5e43f35a.js">
    <link rel="stylesheet" href="/blogs/assets/css/0.styles.49137356.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blogs/" class="home-link router-link-active"><!----> <span class="site-name">YRcoder</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blogs/grammar/htmlCss.html" class="nav-link">语法</a></div><div class="nav-item"><a href="/blogs/ruminate/前端的总结.html" class="nav-link">反刍</a></div><div class="nav-item"><a href="/blogs/other/createNote.html" class="nav-link">other</a></div><div class="nav-item"><a href="/blogs/excerpt/excerpt.html" class="nav-link">摘抄</a></div> <a href="https://github.com/yrcoder" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blogs/grammar/htmlCss.html" class="nav-link">语法</a></div><div class="nav-item"><a href="/blogs/ruminate/前端的总结.html" class="nav-link">反刍</a></div><div class="nav-item"><a href="/blogs/other/createNote.html" class="nav-link">other</a></div><div class="nav-item"><a href="/blogs/excerpt/excerpt.html" class="nav-link">摘抄</a></div> <a href="https://github.com/yrcoder" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>一层语法</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blogs/grammar/htmlCss.html" class="sidebar-link">html</a></li><li><a href="/blogs/grammar/less.html" class="sidebar-link">less</a></li><li><a href="/blogs/grammar/js.html" class="sidebar-link">JavaScript</a></li><li><a href="/blogs/grammar/es6.html" class="sidebar-link">ES6</a></li><li><a href="/blogs/grammar/vue.html" class="sidebar-link">vue</a></li><li><a href="/blogs/grammar/react.html" class="sidebar-link">react</a></li><li><a href="/blogs/grammar/managingState.html" class="sidebar-link">mobx</a></li><li><a href="/blogs/grammar/router.html" class="sidebar-link">router</a></li><li><a href="/blogs/grammar/debug.html" class="sidebar-link">调试</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>二层语法</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blogs/grammar/webpack.html" class="sidebar-link">webpack</a></li><li><a href="/blogs/grammar/git.html" class="sidebar-link">git</a></li><li><a href="/blogs/grammar/vueSSR.html" class="sidebar-link">vueSSR</a></li><li><a href="/blogs/grammar/reactSSR.html" class="sidebar-link">ReactSSR</a></li><li><a href="/blogs/grammar/nginx.html" class="sidebar-link">nginx</a></li><li><a href="/blogs/grammar/http.html" class="sidebar-link">http</a></li><li><a href="/blogs/grammar/node.html" class="sidebar-link">node</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>三层语法</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blogs/grammar/reactDesignPattern.html" class="sidebar-link">react 设计模式和最佳实战</a></li><li><a href="/blogs/grammar/jsDesignPattern.html" class="sidebar-link">javascript 设计模式</a></li><li><a href="/blogs/grammar/zepto源码.html" class="sidebar-link">zepto 设计和源码分析</a></li><li><a href="/blogs/grammar/vue源码.html" class="sidebar-link">vue 源码</a></li><li><a href="/blogs/grammar/react源码.html" class="sidebar-link">react 源码</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="shell"><a href="#shell" aria-hidden="true" class="header-anchor">#</a> shell</h1> <p>此权限时使用命令 chattr 的 a 属性来设置的，具体命令为：
sudo chattr +a file(filename)
取消此权限命令：
sudo chattr -a file(filename)</p> <p>若递归的设置文件夹的此种权限，使用-R 属性：
sudo chattr +a -R file(filename)
递归取消文件夹的此属性：
sudo chattr -a -R file(filename)</p> <h1 id="linux"><a href="#linux" aria-hidden="true" class="header-anchor">#</a> linux</h1> <p>吾注：
文件的增删改查
用户的权限(什么人可以增删改查)
各种软件的安装和使用(环境变量，开机启动，进程管理等等)</p> <p>大小写区分
一切皆文件
后缀名不重要</p> <p>有没有公网 IP 区分是不是服务器</p> <p>CentOs
虚拟机是什么？
virtualbox
安装虚拟机电脑要支持虚拟化，BIOS 开启虚拟化支持。
在虚拟机中安装操作系统
安装 centOs
网络设置成桥接
改变默认源</p> <p>准备工作
ifconfig
ip addr
vi /etc/sysconfig/network-scripts/ifcfg (tab 键提示)
yum install net-tools (可以用 ifconfig 命令)</p> <p>vi /etc/sysconfig/network-scripts/ifcfg
把 ONBOOT 设置为 yes
将网络服务重启
service network restart</p> <p>cat /etc/redhat-release</p> <p>yum install wget</p> <h1 id="ssh-一个协议-类似-http-协议"><a href="#ssh-一个协议-类似-http-协议" aria-hidden="true" class="header-anchor">#</a> ssh 一个协议(类似 http 协议)</h1> <p>ssh： secure shell 安全外壳协议
远程链接的方案
建立在应用层基础上的安全协议，可靠，专为远程登录会话和其他网络服务提供安全性的协议
有效防止远程管理过程中对信息泄露问题
ssh 客户端适用于多种平台
ssh 服务端几乎支持所有 UNIX 平台</p> <p>在服务器中安装 ssh 服务
yum install openssh-server
启动
service sshd start
设置开机运行
chkconfig sshd on
查看进程是否存在
ps -ef |grep ssh</p> <p>客户端安装 ssh 工具
window: xshell
linux: 执行命令 yum install openssh-clients</p> <p>链接命令
ssh root@xxx.xxx.xxx
exit</p> <p>ssh config
方便批量管理多个 ssh
config 存放在 ～/.ssh/config
配置语法：
查看是不是能连上
ping 192.168.0.022
cd ~/.ssh/
新建文件
touch config
编辑文件
vim config
内容
host &quot;lyr&quot;
HostName 192.168.0.102
User root
Port 22
设置完之后再链接不需要输入 ssh root@192.168.0.102
只需要输入 ssh lyr</p> <p>多台服务器
host &quot;lyr&quot;
HostName 192.168.0.102
User root
Port 22</p> <p>host &quot;lyr2&quot;
HostName 192.168.0.102
User root
Port 22</p> <p>免密登录
ssh key 使用非对称加密方式生成公钥和私钥，存放在～/.ssh 目录
公钥可以对外公开
～/.ssh/authorized_keys
生成 ssh key
ssh-keygen -t rsa 或者 ssh-keygen -t dsa</p> <p>ssh 安全端口
默认 22
修改端口
vim /etc/ssh/sshd_config
服务重启
service sshd restart</p> <h1 id="常用命令"><a href="#常用命令" aria-hidden="true" class="header-anchor">#</a> 常用命令</h1> <ul><li>软件操作命令</li></ul> <p>软件包管理器：yum
安装软件：yum install xxx
卸载：yum remove xxx
搜索：yum search xxx
清理缓存：yum clean packages
列出已安装：yum list
软件包信息：yum info xxx</p> <ul><li>服务器硬件资源和磁盘操作</li></ul> <p>查看内存：free -m (-m 以 M 的形式展示)
硬盘：df -h (-h 是以人类可以看的懂的形式展示)
负载：w/top (1 说明满了)
cpu 个数和核数：cat /proc/cpuinfo
格式化磁盘：fdisk</p> <ul><li>文件和文件夹操作命令</li></ul> <p>目录结构</p> <pre><code>* 根目录 /
* 家目录 /home
* 临时目录 /tmp
* 配置目录 /etc
* 用户程序目录 /usr
/usr/bin
/usr/sbin
</code></pre> <p>命令</p> <pre><code>* ls; ls -al === ll
* touch; 新建文件
* mkdir; 新建文件夹。 循环新建: mkdir -p lyr/test/test1;
* rm; rm 删除文件。 删除文件夹: rm -r xxx; 强制删除: rm -rf xxx
* cp 源文件路径 目标路径; 复制文件
* mv 源文件路径 目标路径; 移动文件
* pwd; 显示当前路径
</code></pre> <p>vim</p> <pre><code>* 首行: G
* 尾行: gg
* 删除当前光标所在行: dd
* 恢复: u
* 复制: yy
* 粘贴: p
* 显示行数: :set number
</code></pre> <p>文件权限 421</p> <pre><code>* r w x -&gt; 1*2*2 + 1 * 2 + 1*1
* 读r: 4
* 写w: 2
* 可执行x: 1
* -rw-r--r--: rw-(读写的权限); r--(读的权限)
* drwxr-xr-x: d表示目录结构;rwx(最高权限，读写可执行);r-x(读和执行);r-x(读和执行)
* 777是最大的权限
</code></pre> <p>文件搜索，查找，读取</p> <pre><code>* tail: 从文件尾部开始读取 tail -f xxx, 当在另一个窗口编辑的时候可以自动读取尾部信息
* head: 从文件头部开始读取
* cat: 读取整个文件
* more: 分页读取, 从头部开始读，按enter键一行一行往下跑
* less: 可控分页
* grep: 搜索关键字, grep 'aaa' xxx(查找文件中带aaa的); grep -n 'aaa' xxx(带行号)
* find: 查找文件, find .(列出当前目录下的所有文件); find . -name &quot;*.c&quot;(找出当前目录下,以.c为结尾的文件名); find . -type f(找出当前目录下的文件); find . -type d(找出当前目录下的文件夹); find . -ctime -20(找出当前目录下20天内更新过的文件, -ctime -20 指当前时间减去20天); find . -type f -mtime + 7(找出当前目录下的7天之前更新过的文件, -mtime 最后更新的时间); find . -type f -perm 777 -exec ls -l {} \(找到当前目录下权限是777的文件并列出它们)
* wc: 统计个数, cat xxx | wc -l (xxx文件总共多少行)
* |: 管道，将第一个命令执行完之后的结果传给第二个命令，grep &quot;2017-08-22 15:30&quot; xxx | more
</code></pre> <p>文件压缩与解压</p> <pre><code>* tar
* man tar; tar 命令的操作手册
* tar -cvf|tvf|xvf
* tar -czvf|tzvf|xzvf
</code></pre> <ul><li><p>系统用户操作命令</p> <ul><li>添加用户: useradd(adduser); adduser lyr_test; /home 文件夹下多一个目录</li> <li>删除用户: userdel [username]; 删除文件之后，文件夹还在, rm -rf /home/lyr_test; userdel -r [username]彻底删除，包括目录</li> <li>设置密码: passwd [username]</li></ul></li></ul> <ul><li><p>防火墙相关设置</p> <ul><li>作用: 保护服务器的安全</li> <li>设置防火墙规则(开放 80, 22, 43 端口)</li> <li>查看是否安装: yum list | grep firewall</li> <li>查看是否启动：ps -ef | grep firewall</li> <li>安装：yum install firewalld</li> <li>启动/重启：service firewalld start/restart</li> <li>检查状态： service firewalld status</li> <li>关闭或者禁用：service firewalld stop/disable</li> <li>简单操作: firewall-cmd --version; firewall-cmd --help;firewall-cmd --get-zones(查看防火墙区域);firewall-cmd --get-default-zones(查看防火墙默认区域);firewall-cmd --list-all-zone(查看防火墙每个区域的配置信息);firewall-cmd --zone=public(查看某个防火墙的区域); firewall-cmd --list-ports(查看防火墙的端口);
firewall-cmd --query-service=ssh(查看是否允许这个服务访问);firewall-cmd --remove-service=ssh(删除服务,删除之后就不能访问了);firewall-cmd --add-service=ssh(添加服务); firewall-cmd --list-service(查询有哪些服务); firewall-cmd --add-port=22/tcp(添加端口，就可以登录了？);firewall-cmd --remove-port=22/tcp(删除端口);</li></ul></li></ul> <ul><li><p>提权操作 sudo 和文件传输操作</p> <ul><li>提权操作：sudo(visudo 编辑 sudo 配置), 找到 ALL 的权限，复制</li> <li>文件下载(wget,curl): wegt http://www/baidu.com; curl -o 我起的名字 http://www/baidu.com;</li> <li>文件上传(scp): scp 本地的文件名 用户+服务器+路径; scp text.txt root@192.168.0.0.1:/tmp/; scp root@192.168.0.0.1:/tmp/text.txt ./; (将服务器上的文件下载到本地当前目录)</li></ul></li></ul> <h1 id="webserver-安装和配置讲解（nginx）"><a href="#webserver-安装和配置讲解（nginx）" aria-hidden="true" class="header-anchor">#</a> webServer 安装和配置讲解（nginx）</h1> <p>安装: yum install nginx
启动，停止，重载: service nginx start/restart/stop/reload
反向代理：隐藏了后台服务器</p> <div class="language-sh extra-class"><pre class="language-text"><code># 负载均衡
upstream lyr_hosts {
    server 192.169.0.092 weight=5;
    server 192.169.0.000 weight=1;
}
server {
    # 可以监听多个端口
    listen 80;
    listen 999;
    # 可以设置多个访问域名
    server_name www.aaa.com www.bbb.com;
    root /data/www;
    index index.html index.htm;
    # 日志的位置，和模式
    access_log /var/log/nginx/access_imooc.log lyr_test;
    location / {
        # 伪静态
        rewrite ^(.*)\.htmp$ /index.html;
        # 反向代理，（后台服务器）
        proxy_pass http://aaa.bbb.com
        # 反向代理可能会用到的规则
        # proxy_set_header Host aaa.bbb.cn
    }
}


# 日志的格式化
vim /etc/nginx/nginx.conf

http {
    # 定义日志格式（可以多个）
    log_format lyr_test '$remote_addr - $&quot;http_user_agent&quot;'
    # 日志的存放路径，和日志格式
    access_log /var/log/nginx/access.log lyr_test;
}
</code></pre></div><h1 id="数据库服务"><a href="#数据库服务" aria-hidden="true" class="header-anchor">#</a> 数据库服务</h1> <h1 id="缓存服务"><a href="#缓存服务" aria-hidden="true" class="header-anchor">#</a> 缓存服务</h1> <h1 id="git"><a href="#git" aria-hidden="true" class="header-anchor">#</a> git</h1> <p>yum install git
命令</p> <h1 id="服务管理"><a href="#服务管理" aria-hidden="true" class="header-anchor">#</a> 服务管理</h1> <ul><li>定时任务：crontab; crontab -e （编辑配置文件）; crontab</li> <li>日期同步：Ntpdate; date; ntpdate; yum install utpdate（安装）; ntpdate cn.pool.ntp.org(同步时间)；rm /etc/localtime; sudo ln -s /usr/share/zoneinfo/Asia/Shanghai /etc/localtime(设置时区)</li> <li>定时同步时间：crontab -l; 文件内容为 <code>*/30**** ntpdate cn.pool.ntp.org</code> 每半个小时同步一次</li> <li>日志切割：Logrotate;</li></ul> <div class="language-sh extra-class"><pre class="language-text"><code>cat /etc/logrotage.d/nginx;
/var/log/nginx/*.log {
    daily
    missingok
    rotate 52
    compress
    deloycompress
    notifempty
    create 640 nginx adm
    sharedscripts
    postrotate
        if[ -f /var/run/gninx.pid ]; then
            kill -USR1 `cat /var/run/nginx.pid`
        fi
    endscript
}
</code></pre></div><ul><li>进程管理：supervisor</li></ul> <div class="language-sh extra-class"><pre class="language-text"><code>pip install supervisor
</code></pre></div><h1 id="监控神器-zabbix"><a href="#监控神器-zabbix" aria-hidden="true" class="header-anchor">#</a> 监控神器 zabbix</h1> <p>可以监控 mysql,等等服务</p></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/blogs/assets/js/14.ca8ee814.js" defer></script><script src="/blogs/assets/js/app.2b612f2a.js" defer></script>
  </body>
</html>
