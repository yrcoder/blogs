<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JavaScript | YRcoder</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/blogs/assets/css/0.styles.49137356.css" as="style"><link rel="preload" href="/blogs/assets/js/app.2b612f2a.js" as="script"><link rel="preload" href="/blogs/assets/js/11.687313e6.js" as="script"><link rel="prefetch" href="/blogs/assets/js/19.32209c0d.js"><link rel="prefetch" href="/blogs/assets/js/2.d8d0300f.js"><link rel="prefetch" href="/blogs/assets/js/3.78bce9f9.js"><link rel="prefetch" href="/blogs/assets/js/4.a3a81660.js"><link rel="prefetch" href="/blogs/assets/js/5.43029159.js"><link rel="prefetch" href="/blogs/assets/js/6.875575e2.js"><link rel="prefetch" href="/blogs/assets/js/7.c9ffc06c.js"><link rel="prefetch" href="/blogs/assets/js/8.93c6ec89.js"><link rel="prefetch" href="/blogs/assets/js/9.84e0ec54.js"><link rel="prefetch" href="/blogs/assets/js/10.db99257f.js"><link rel="prefetch" href="/blogs/assets/js/12.28f8784f.js"><link rel="prefetch" href="/blogs/assets/js/13.0b2e299e.js"><link rel="prefetch" href="/blogs/assets/js/14.ca8ee814.js"><link rel="prefetch" href="/blogs/assets/js/15.043efc1f.js"><link rel="prefetch" href="/blogs/assets/js/16.9a7002c8.js"><link rel="prefetch" href="/blogs/assets/js/17.e74890e2.js"><link rel="prefetch" href="/blogs/assets/js/18.faaea426.js"><link rel="prefetch" href="/blogs/assets/js/20.fce76639.js"><link rel="prefetch" href="/blogs/assets/js/21.1ac604c1.js"><link rel="prefetch" href="/blogs/assets/js/22.5cc26646.js"><link rel="prefetch" href="/blogs/assets/js/23.26b6189b.js"><link rel="prefetch" href="/blogs/assets/js/24.243fe967.js"><link rel="prefetch" href="/blogs/assets/js/25.00d13d8e.js"><link rel="prefetch" href="/blogs/assets/js/26.9793daa6.js"><link rel="prefetch" href="/blogs/assets/js/27.5e040fb5.js"><link rel="prefetch" href="/blogs/assets/js/28.eac84346.js"><link rel="prefetch" href="/blogs/assets/js/29.ac1518e6.js"><link rel="prefetch" href="/blogs/assets/js/30.cb0249c5.js"><link rel="prefetch" href="/blogs/assets/js/31.1f406963.js"><link rel="prefetch" href="/blogs/assets/js/32.27c448e1.js"><link rel="prefetch" href="/blogs/assets/js/33.66d1b1d4.js"><link rel="prefetch" href="/blogs/assets/js/34.8f89af58.js"><link rel="prefetch" href="/blogs/assets/js/35.95d09688.js"><link rel="prefetch" href="/blogs/assets/js/36.0cdd6acb.js"><link rel="prefetch" href="/blogs/assets/js/37.f7075148.js"><link rel="prefetch" href="/blogs/assets/js/38.13ffb522.js"><link rel="prefetch" href="/blogs/assets/js/39.4edced61.js"><link rel="prefetch" href="/blogs/assets/js/40.5e43f35a.js">
    <link rel="stylesheet" href="/blogs/assets/css/0.styles.49137356.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blogs/" class="home-link router-link-active"><!----> <span class="site-name">YRcoder</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blogs/grammar/htmlCss.html" class="nav-link">语法</a></div><div class="nav-item"><a href="/blogs/ruminate/前端的总结.html" class="nav-link">反刍</a></div><div class="nav-item"><a href="/blogs/other/createNote.html" class="nav-link">other</a></div><div class="nav-item"><a href="/blogs/excerpt/excerpt.html" class="nav-link">摘抄</a></div> <a href="https://github.com/yrcoder" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blogs/grammar/htmlCss.html" class="nav-link">语法</a></div><div class="nav-item"><a href="/blogs/ruminate/前端的总结.html" class="nav-link">反刍</a></div><div class="nav-item"><a href="/blogs/other/createNote.html" class="nav-link">other</a></div><div class="nav-item"><a href="/blogs/excerpt/excerpt.html" class="nav-link">摘抄</a></div> <a href="https://github.com/yrcoder" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>一层语法</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blogs/grammar/htmlCss.html" class="sidebar-link">html</a></li><li><a href="/blogs/grammar/less.html" class="sidebar-link">less</a></li><li><a href="/blogs/grammar/js.html" class="active sidebar-link">JavaScript</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blogs/grammar/js.html#js-面试技巧" class="sidebar-link">js 面试技巧</a></li><li class="sidebar-sub-header"><a href="/blogs/grammar/js.html#js-基础知识" class="sidebar-link">js 基础知识</a></li><li class="sidebar-sub-header"><a href="/blogs/grammar/js.html#js-web-api" class="sidebar-link">js-web-api</a></li><li class="sidebar-sub-header"><a href="/blogs/grammar/js.html#开发环境" class="sidebar-link">开发环境</a></li><li class="sidebar-sub-header"><a href="/blogs/grammar/js.html#运行环境" class="sidebar-link">运行环境</a></li><li class="sidebar-sub-header"><a href="/blogs/grammar/js.html#高级基础" class="sidebar-link">高级基础</a></li><li class="sidebar-sub-header"><a href="/blogs/grammar/js.html#框架原理" class="sidebar-link">框架原理</a></li><li class="sidebar-sub-header"><a href="/blogs/grammar/js.html#app-混合开发" class="sidebar-link">app 混合开发</a></li><li class="sidebar-sub-header"><a href="/blogs/grammar/js.html#js-概观" class="sidebar-link">js 概观</a></li><li class="sidebar-sub-header"><a href="/blogs/grammar/js.html#表达式和操作符" class="sidebar-link">表达式和操作符</a></li><li class="sidebar-sub-header"><a href="/blogs/grammar/js.html#语句" class="sidebar-link">语句</a></li><li class="sidebar-sub-header"><a href="/blogs/grammar/js.html#函数" class="sidebar-link">函数</a></li><li class="sidebar-sub-header"><a href="/blogs/grammar/js.html#内置对象" class="sidebar-link">内置对象</a></li><li class="sidebar-sub-header"><a href="/blogs/grammar/js.html#dom-基础" class="sidebar-link">DOM 基础</a></li><li class="sidebar-sub-header"><a href="/blogs/grammar/js.html#dom-事件" class="sidebar-link">DOM 事件</a></li><li class="sidebar-sub-header"><a href="/blogs/grammar/js.html#bom" class="sidebar-link">BOM</a></li><li class="sidebar-sub-header"><a href="/blogs/grammar/js.html#轮播图小技巧" class="sidebar-link">轮播图小技巧</a></li><li class="sidebar-sub-header"><a href="/blogs/grammar/js.html#正则表达式" class="sidebar-link">正则表达式</a></li><li class="sidebar-sub-header"><a href="/blogs/grammar/js.html#js事件循环，宏微任务" class="sidebar-link">js事件循环，宏微任务</a></li><li class="sidebar-sub-header"><a href="/blogs/grammar/js.html#js事件轮询event-loop" class="sidebar-link">js事件轮询event loop</a></li><li class="sidebar-sub-header"><a href="/blogs/grammar/js.html#浏览器的基本工作原理" class="sidebar-link">浏览器的基本工作原理</a></li></ul></li><li><a href="/blogs/grammar/es6.html" class="sidebar-link">ES6</a></li><li><a href="/blogs/grammar/vue.html" class="sidebar-link">vue</a></li><li><a href="/blogs/grammar/react.html" class="sidebar-link">react</a></li><li><a href="/blogs/grammar/managingState.html" class="sidebar-link">mobx</a></li><li><a href="/blogs/grammar/router.html" class="sidebar-link">router</a></li><li><a href="/blogs/grammar/debug.html" class="sidebar-link">调试</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>二层语法</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blogs/grammar/webpack.html" class="sidebar-link">webpack</a></li><li><a href="/blogs/grammar/git.html" class="sidebar-link">git</a></li><li><a href="/blogs/grammar/vueSSR.html" class="sidebar-link">vueSSR</a></li><li><a href="/blogs/grammar/reactSSR.html" class="sidebar-link">ReactSSR</a></li><li><a href="/blogs/grammar/nginx.html" class="sidebar-link">nginx</a></li><li><a href="/blogs/grammar/http.html" class="sidebar-link">http</a></li><li><a href="/blogs/grammar/node.html" class="sidebar-link">node</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>三层语法</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blogs/grammar/reactDesignPattern.html" class="sidebar-link">react 设计模式和最佳实战</a></li><li><a href="/blogs/grammar/jsDesignPattern.html" class="sidebar-link">javascript 设计模式</a></li><li><a href="/blogs/grammar/zepto源码.html" class="sidebar-link">zepto 设计和源码分析</a></li><li><a href="/blogs/grammar/vue源码.html" class="sidebar-link">vue 源码</a></li><li><a href="/blogs/grammar/react源码.html" class="sidebar-link">react 源码</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="javascript"><a href="#javascript" aria-hidden="true" class="header-anchor">#</a> JavaScript</h1> <h2 id="js-面试技巧"><a href="#js-面试技巧" aria-hidden="true" class="header-anchor">#</a> js 面试技巧</h2> <p>基础工程师：基础知识
高级工程师：项目经验
架构师：解决方案</p> <h3 id="几个面试题"><a href="#几个面试题" aria-hidden="true" class="header-anchor">#</a> 几个面试题</h3> <ul><li>typeof 能得到哪些类型 <code>==&gt;</code> 考点：数据类型</li> <li>=== 和 == <code>==&gt;</code> 考点：数据类型强制转换</li> <li>window.onload 和 DOMContentLoaded 的区别 <code>==&gt;</code> 考点：浏览器渲染过程</li> <li>用 js 创建 10 个 a 标签，点击的时候弹出对应的序号 <code>==&gt;</code> 考点：作用域 (为什么不是事件委托？)</li> <li>简述如何实现一个模块加载器，实现类似 require.js 的基本功能 <code>==&gt;</code> 考点：模块化</li> <li>实现数组的随机排序 <code>==&gt;</code> js 基础算法</li></ul> <h2 id="js-基础知识"><a href="#js-基础知识" aria-hidden="true" class="header-anchor">#</a> js 基础知识</h2> <p>原型，原型链
作用域，闭包
异步，单线程</p> <h3 id="原型，原型链"><a href="#原型，原型链" aria-hidden="true" class="header-anchor">#</a> 原型，原型链</h3> <p>知识点</p> <ol><li>构造函数</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span>age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token operator">=</span> <span class="token string">'class-1'</span>
    <span class="token comment">// return this // 默认有这一行</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> f <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token string">'lyr'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token comment">// new 的时候this会先变成一个空对象，</span>

<span class="token comment">// 扩展</span>
<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 是 <span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 的语法糖
<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 是 <span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 的语法糖
<span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> 是 <span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 的语法糖

<span class="token comment">// 使用 instanceof 判断一个函数是否是一个变量的构造函数</span>
<span class="token comment">// 判断变量是不是数组</span>
<span class="token comment">// 变量 instanceof Array</span>
</code></pre></div><ol start="2"><li>原型规则和实例, 原型链和instanceof</li></ol> <ul><li>所有的引用类型除了null（数组，对象，函数）都具有对象的特性，可自由扩展属性</li> <li>所有的引用类型除了null（数组，对象，函数）都具有__proto__属性(隐式原型), 属性值是一个普通的对象</li> <li>所有的函数都有一个prototype属性(显式原型), 属性值也是一个普通的对象</li> <li>所有的引用类型除了null（数组，对象，函数）, __proto__属性值指向它的构造函数的prototype属性值</li> <li>当试图得到一个对象的某个属性时，如果这个对象本身没有这个属性，那么会去它的__proto__(也就是它的构造函数的prototype)中寻找</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// 所有的引用类型除了null（数组，对象，函数）都具有对象的特性，可自由扩展属性</span>
obj<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">100</span>
arr<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">100</span>
fn<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">100</span>
<span class="token comment">// 所有的引用类型除了null（数组，对象，函数）都具有__proto__属性, 属性值是一个普通的对象</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fn<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span>
<span class="token comment">// 所有的函数都有一个prototype属性, 属性值也是一个普通的对象</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fn<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>
<span class="token comment">// 所有的引用类型除了null（数组，对象，函数）, __proto__属性值指向它的构造函数的prototype属性值</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> Object<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>
<span class="token comment">// 当试图得到一个对象的某个属性时，如果这个对象本身没有这个属性，那么会去它的__proto__(也就是它的构造函数的prototype)中寻找</span>
<span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name <span class="token comment">// this指的时实例f</span>
<span class="token punctuation">}</span>
Foo<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">alertName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// this指的时实例f</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> f <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token string">'lyr'</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span><span class="token function-variable function">printName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// this指的时实例f</span>
<span class="token punctuation">}</span>
f<span class="token punctuation">.</span><span class="token function">printName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span><span class="token function">alertName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> item <span class="token keyword">in</span> f<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 只遍历本身的属性，不遍历原型的属性</span>
        <span class="token comment">// 高级浏览器已经在for in中屏蔽的来自原型的属性</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 原型链</span>
f<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 要去f.__proto__.__proto__ ... 中去找</span>

<span class="token comment">// instanceof</span>
f <span class="token keyword">instanceof</span> <span class="token class-name">Foo</span><span class="token punctuation">;</span> <span class="token comment">// f的__proto__ 一层一层往上，能否对应到 Foo.prototype</span>
f <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">;</span> <span class="token comment">// f的__proto__ 一层一层往上，能否对应到 Object.prototype</span>
</code></pre></div><p>题目1: 如何准确判断一个变量是数组类型: <code>arr instanceOf Array</code>
题目2: 描述new一个对象的过程</p> <ol><li>创建一个新对象</li> <li>this指向这个新对象</li> <li>执行代码，即对this赋值</li> <li>返回 this
题目3: 写一个原型链继承的例子</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 封装dom查询到例子</span>
<span class="token keyword">function</span> <span class="token function">Elem</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>elem <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
Elem<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">html</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> elem <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>elem
    <span class="token keyword">if</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        elem<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> val
        <span class="token keyword">return</span> <span class="token keyword">this</span> <span class="token comment">// 链式操作</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> elem<span class="token punctuation">.</span>innerHTML
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
Elem<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">on</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> fn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> elem <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>elem
    elem<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> fn<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span> <span class="token comment">// 链式操作</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> div1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Elem</span><span class="token punctuation">(</span><span class="token string">'div1'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>div1<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
div1<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token string">'&lt;a&gt;点击&lt;/a&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="作用域，闭包"><a href="#作用域，闭包" aria-hidden="true" class="header-anchor">#</a> 作用域，闭包</h3> <p>知识点：</p> <ol><li>执行上下文
js 是解释型语言, 在函数执行之前会把变量定义和函数声明先拿出来占个位，然后解析
范围: 一段script或者一个函数
全局(script): 变量定义, 函数声明
函数: 变量定义, 函数声明, this, arguments</li></ol> <p>PS: 函数声明 不是 函数表达式 <code>const a = function() {}</code></p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token comment">// undefined</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">100</span>
<span class="token comment">// 等价于</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> undefined
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
a <span class="token operator">=</span> <span class="token number">100</span>

<span class="token function">fn</span><span class="token punctuation">(</span><span class="token string">'lyr'</span><span class="token punctuation">)</span> <span class="token comment">// 'lyr' 20</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    age <span class="token operator">=</span> <span class="token number">20</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span>
    <span class="token keyword">var</span> age

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 等价于</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> age
    age <span class="token operator">=</span> <span class="token number">20</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token comment">// window</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token string">'lyr'</span><span class="token punctuation">)</span>
</code></pre></div><ol start="2"><li>this
this在执行时才能确认值, 定义时无法确认
执行的场景：
作为构造函数执行: this指的是实例
作为对象属性执行: this指的是那个对象
作为普通函数执行: this指的是window
call apply bind: this是绑定的那个对象</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">'a'</span><span class="token punctuation">,</span>
    fn<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'b'</span><span class="token punctuation">}</span>
a<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// this === a</span>
a<span class="token punctuation">.</span>fn<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token comment">// this === b</span>
<span class="token keyword">const</span> fn <span class="token operator">=</span> a<span class="token punctuation">.</span>fn
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// this === window</span>

<span class="token comment">// 构造函数</span>
<span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token keyword">this</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
    <span class="token keyword">return</span> <span class="token keyword">this</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> f <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token string">'lyr'</span><span class="token punctuation">)</span>

<span class="token comment">// call apply bind</span>
<span class="token keyword">function</span> <span class="token function">fn1</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
fn1<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">{</span>x<span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'call'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
fn1<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token punctuation">{</span>x<span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'apply'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token function-variable function">fn2</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token punctuation">{</span>x<span class="token punctuation">:</span> <span class="token number">300</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">fn2</span><span class="token punctuation">(</span><span class="token string">'bind'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
</code></pre></div><ol start="3"><li>作用域
没有块级作用域(大括号)
只有函数和全局作用域
es6中有块级作用域</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 没有块级作用域</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'lyr'</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token comment">// lyr</span>

<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token comment">// 10</span>
<span class="token comment">// es6</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> age <span class="token operator">=</span> <span class="token number">10</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span> <span class="token comment">// error: age is not defined</span>

<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token comment">// i is not defined</span>
<span class="token comment">// 函数和全局作用域</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">100</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">200</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'fn'</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'global'</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><ol start="4"><li>作用域链
自由变量：当前作用域没有定义的变量</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 定义时的父级作用域</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">100</span>
<span class="token keyword">function</span> <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">200</span>
    <span class="token keyword">function</span> <span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token number">300</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><ol start="5"><li>闭包</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 父级作用域是定义时候的作用域，而不是执行时候的作用域</span>

<span class="token comment">// 函数作为返回值</span>
<span class="token keyword">function</span> <span class="token constant">F1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">100</span>
    <span class="token keyword">const</span> <span class="token function-variable function">b</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token comment">// a 自由变量，向父级作用域去寻找 -- 函数定义的父级作用域</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> b
<span class="token punctuation">}</span>
<span class="token keyword">var</span> f1 <span class="token operator">=</span> <span class="token constant">F1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// f1 === b</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">2000</span>
<span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 100, 函数执行是全局作用域</span>

<span class="token comment">// 函数作为参数</span>
<span class="token keyword">function</span> <span class="token constant">F1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">100</span>
    <span class="token keyword">const</span> <span class="token function-variable function">b</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token comment">// a 自由变量，向父级作用域去寻找 -- 函数定义的父级作用域</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> b
<span class="token punctuation">}</span>
<span class="token keyword">var</span> f1 <span class="token operator">=</span> <span class="token constant">F1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// fn === b</span>
<span class="token keyword">function</span> <span class="token constant">F2</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">300</span>
    <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token constant">F2</span><span class="token punctuation">(</span>f1<span class="token punctuation">)</span>
</code></pre></div><p>题目1: 对变量提升的理解
题目2: this几种不同的使用场景
题目3: 创建10个a标签，点击弹出对应的序号</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 错误</span>
<span class="token keyword">var</span> i<span class="token punctuation">,</span> a
<span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    a <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
    a<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token string">'&lt;br&gt;'</span>
    a<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">alert</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token comment">// 自由变量，要去父作用域取值, 所有点击的结果都是10</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 正确</span>
<span class="token keyword">var</span> i<span class="token punctuation">,</span> a
<span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        a <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
        a<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token string">'&lt;br&gt;'</span>
        a<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token function">alert</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token comment">// 自由变量，要去父作用域取值</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>题目4: 如何理解作用域
自由变量，作用域链，即自由变量的查找，闭包的两个场景
题目5: 实际开发中闭包的应用：封装变量，收敛权限</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">isFirstLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> _list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>_list<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            _list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> firstLoad <span class="token operator">=</span> <span class="token function">isFirstLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">firstLoad</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token function">firstLoad</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
<span class="token function">firstLoad</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre></div><h3 id="异步，单线程"><a href="#异步，单线程" aria-hidden="true" class="header-anchor">#</a> 异步，单线程</h3> <p>知识点:</p> <ol><li>什么是异步:
同步: 阻塞
异步: 执行完之后在回来执行。
等待的场景都需要异步
定时任务: setTimeout, setInverval
网络请求: ajax, 动态img加载
事件绑定</li> <li>前端使用异步的场景</li> <li>异步和单线程</li></ol> <p>题目1: 同步和异步的区别？各举一例
题目2: 一个关于setTimeout的笔试题
题目3: 前端使用异步的场景</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// alert() 同步</span>

<span class="token comment">// 结果：start, end, ajax</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'start'</span><span class="token punctuation">)</span>
$<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'/a.json'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ajax'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">)</span>

<span class="token comment">// 结果：start, end, img</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'start'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span>
img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// img.onerror = function() {</span>
<span class="token comment">//     console.log('onerror')</span>
<span class="token comment">// }</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">)</span>

<span class="token comment">// 结果：start, end, button</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'start'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'btn'</span><span class="token punctuation">)</span>
btn<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'btn'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">)</span>

<span class="token comment">// 异步和单线程</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>

</code></pre></div><h3 id="其他"><a href="#其他" aria-hidden="true" class="header-anchor">#</a> 其他</h3> <p>知识点</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 日期和math</span>
Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 当前时间毫秒数</span>
<span class="token keyword">const</span> dt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
dt<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 毫秒数</span>
dt<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 年</span>
dt<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 月 0-11</span>
dt<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 日 0-31</span>
dt<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 时 0-23</span>
dt<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 分 0-59</span>
dt<span class="token punctuation">.</span><span class="token function">getSeconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 秒 0-59</span>

获取随机数 Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 数组和对象</span>
<span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
arr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> index<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
arr<span class="token punctuation">.</span><span class="token function">every</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>item <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
arr<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>item <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

arr<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>item <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
arr<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>a<span class="token operator">-</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>
arr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>a<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> b<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> key
<span class="token keyword">for</span><span class="token punctuation">(</span>key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol><li>获取 2017-06-10 格式的日期</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">formatDate</span><span class="token punctuation">(</span>dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        dt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> year <span class="token operator">=</span> dt<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> month <span class="token operator">=</span> dt<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">const</span> date <span class="token operator">=</span> dt<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>month <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        month <span class="token operator">=</span> <span class="token string">'0'</span> <span class="token operator">+</span> month
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>date <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        date <span class="token operator">=</span> <span class="token string">'0'</span> <span class="token operator">+</span> date
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>year<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>month<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>date<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>获取随机数，要求是长度一致的字符串格式</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> random <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
random <span class="token operator">=</span> random <span class="token operator">=</span> <span class="token string">'0000000000'</span>
random <span class="token operator">=</span> random<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>random<span class="token punctuation">)</span>

</code></pre></div><ol start="3"><li>一个能遍历对象和数组的通用的forEach函数</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">forEach</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> fn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> key
    <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">Array</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        obj<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">fn</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span>key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">fn</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 应用</span>
<span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span>
<span class="token function">forEach</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token punctuation">(</span>index<span class="token punctuation">,</span> item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> item<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">forEach</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token punctuation">(</span>key<span class="token punctuation">,</span> val<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> item<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="js-web-api"><a href="#js-web-api" aria-hidden="true" class="header-anchor">#</a> js-web-api</h2> <p>JS基础知识： ECMA 262标准：定义js基础相关的东西，包括变量类型、原型、作用域、异步（Object, Array, Boolean, String, Math, JSON等）
js-web-api： W3C标准：定义js操作页面的API和全局变量(window, document, navigator.userAgent等)
W3C js相关：DOM 操作、BOM操作、Ajax（包括http协议）、事件绑定、存储（W3C还包括CSS和HTML）</p> <h3 id="dom-操作"><a href="#dom-操作" aria-hidden="true" class="header-anchor">#</a> DOM 操作</h3> <p>Document Object Model: 文档对象模型
知识点：</p> <ol><li>DOM 本质
xml: 可扩展的语言，可以描述任何一个结构化的数据, 标签组成的树，标签可以自定义
html: 特殊的xml，就是一个字符串。这个文件要让js可以处理，就要转化，什么好处理，结构化的东西好处理，浏览器把这个字符串结构化成树，每个元素就是一个对象，让js可以操作。
DOM: 浏览器把拿到等html代码，结构化一个浏览器可以识别并且js可以操作的一个模型。</li> <li>DOM节点操作
Attribute: 标签的属性 style, getAttribute, setAttribute 赋值，取值
prototype: js对象的属性，className 像普通的一样 赋值，取值</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 获取dom节点</span>
docuemnt<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'div1'</span><span class="token punctuation">)</span> <span class="token comment">// 元素</span>
document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span> <span class="token comment">// 集合</span>
document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">'.container'</span><span class="token punctuation">)</span> <span class="token comment">// 集合</span>
<span class="token keyword">const</span> pList <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span> <span class="token comment">// 集合</span>
集合就是类数组<span class="token punctuation">:</span> length<span class="token punctuation">,</span> arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token keyword">const</span> p <span class="token operator">=</span> pList<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
p<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token comment">// 获取样式</span>
p<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token string">'100px'</span> <span class="token comment">// 修改样式</span>
p<span class="token punctuation">.</span>className <span class="token comment">// 获取class</span>
p<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">'p1'</span> <span class="token comment">// 修改class</span>

<span class="token comment">// prototype</span>
p<span class="token punctuation">.</span>nodeName <span class="token comment">// p 获取元素标签名</span>
p<span class="token punctuation">.</span>nodeType <span class="token comment">// 获取元素标签类型</span>
<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token punctuation">:</span> <span class="token number">111</span><span class="token punctuation">,</span> b<span class="token punctuation">:</span> <span class="token number">222</span><span class="token punctuation">}</span> <span class="token comment">// obj.a 就是prototype</span>

<span class="token comment">// Attribute</span>
p<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'data-name'</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'data-name'</span><span class="token punctuation">,</span> <span class="token string">'lyr'</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'style'</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'style'</span><span class="token punctuation">,</span> <span class="token string">'font-size: 20px;'</span><span class="token punctuation">)</span>
</code></pre></div><ol start="3"><li>DOM结构操作（一个树的操作）
新增节点
获取父元素
获取子元素
删除节点
遍历，递归什么的</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 新增节点</span>
<span class="token keyword">var</span> div1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'div1'</span><span class="token punctuation">)</span>
<span class="token comment">// 新增新节点</span>
<span class="token keyword">var</span> p1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span>
p1<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">'1111'</span>
div1<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span>
<span class="token comment">// 移动已有节点(原来的地方就没有了)</span>
<span class="token keyword">var</span> p2 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'p2'</span><span class="token punctuation">)</span>
div1<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span>
<span class="token comment">// 获取父元素</span>
p1<span class="token punctuation">.</span>parentElement
div1<span class="token punctuation">.</span>parentElement
<span class="token comment">// 获取子元素</span>
div1<span class="token punctuation">.</span>childNodes <span class="token comment">// 数组 [text, p#p1, text, p#p2, text] 会把换行，空格等作为文本显示出来</span>
<span class="token comment">// 把空节点获取出来，nodeType === 3 是text，nodeType === 1是常规的标签节点。nodeName === 'P' nodeName=== '#text'</span>
<span class="token comment">// 删除节点</span>
<span class="token keyword">const</span> childNodes <span class="token operator">=</span> div1<span class="token punctuation">.</span>childNodes
div1<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>childNodes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>题目1: DOM是哪种基本的数据结构？
树
题目2: DOM操作的常用API？
获取DOM节点，以及节点的property和Attribute
获取父节点，子节点
新增节点，删除节点
题目3: DOM节点等attr和property有什么区别？
property: 只是一个js对象的属性修改
attribute：是对html标签属性的修改</p> <h3 id="bom操作"><a href="#bom操作" aria-hidden="true" class="header-anchor">#</a> BOM操作</h3> <p>Browser Object Model：浏览器对象模型
知识点
navigator
screen
location
history</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// navigator</span>
<span class="token keyword">var</span> ua <span class="token operator">=</span> navigator<span class="token punctuation">.</span>userAgent
<span class="token keyword">var</span> isChrome <span class="token operator">=</span> ua<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'Chrome'</span><span class="token punctuation">)</span>
<span class="token comment">// screen</span>
screen<span class="token punctuation">.</span>width
screen<span class="token punctuation">.</span>height
<span class="token comment">// location</span>
location<span class="token punctuation">.</span>href <span class="token comment">// 全部</span>
location<span class="token punctuation">.</span>protocol <span class="token comment">// 协议 http</span>
location<span class="token punctuation">.</span>host <span class="token comment">// 域名 XXX.com</span>
locatoin<span class="token punctuation">.</span>pathname <span class="token comment">// /aaa.html</span>
location<span class="token punctuation">.</span>search <span class="token comment">// ?a=1111</span>
location<span class="token punctuation">.</span>hash <span class="token comment">// #mid=100</span>
<span class="token comment">// history</span>
history<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
history<span class="token punctuation">.</span><span class="token function">forward</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>题目1: 检测浏览器的类型
题目2: 解析url的各部分</p> <h3 id="事件绑定"><a href="#事件绑定" aria-hidden="true" class="header-anchor">#</a> 事件绑定</h3> <p>知识点：</p> <ol><li>通用事件绑定</li> <li>事件冒泡</li> <li>代理</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 一个通用的事件监听函数</span>
<span class="token keyword">var</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'btn1'</span><span class="token punctuation">)</span>
btn<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'clicked'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">bindEvent</span><span class="token punctuation">(</span>elem<span class="token punctuation">,</span> type<span class="token punctuation">,</span> fn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    elem<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> fn<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'link1'</span><span class="token punctuation">)</span>
<span class="token function">bindEvent</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 阻止默认行为</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'clicked'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// IE兼容问题</span>
attachEvent

<span class="token comment">// 事件冒泡, 先触发本身节点事件--&gt;父级元素事件--&gt; ... --&gt; body事件</span>
<span class="token keyword">var</span> child <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> wrap <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'wrap'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> body <span class="token operator">=</span> document<span class="token punctuation">.</span>body
e<span class="token punctuation">.</span><span class="token function">stopPropatation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 阻止冒泡，child不会触发wrap和body事件</span>
<span class="token comment">// 代理(会随时增加子元素)</span>
wrap<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> target <span class="token operator">=</span> e<span class="token punctuation">.</span>target <span class="token comment">// 事件在哪儿触发的就是target</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>nodeName <span class="token operator">===</span> <span class="token string">'A'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>innerHTML<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>题目1: 编写一个通用的事件监听函数</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">bindEvent</span><span class="token punctuation">(</span>elem<span class="token punctuation">,</span> type<span class="token punctuation">,</span> selector<span class="token punctuation">,</span> fn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>fn <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        fn <span class="token operator">=</span> selector
        selector <span class="token operator">=</span> <span class="token keyword">null</span>
    <span class="token punctuation">}</span>
    elem<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> target
        <span class="token keyword">if</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            target <span class="token operator">=</span> e<span class="token punctuation">.</span>targert
            <span class="token keyword">if</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                fn<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> e<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">fn</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 使用代理</span>
<span class="token keyword">var</span> wrap <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'wrap'</span><span class="token punctuation">)</span>
<span class="token function">bindEvent</span><span class="token punctuation">(</span>wrap<span class="token punctuation">,</span> <span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>innerHTML<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 不适用代理</span>
<span class="token keyword">var</span> child <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'a1'</span><span class="token punctuation">)</span>
<span class="token function">bindEvent</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> <span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child<span class="token punctuation">.</span>innerHTML<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>题目2: 描述事件冒泡流程
DOM 树形结构
冒泡
阻止冒泡
题目3: 对于一个无限下拉加载图片的页面，如何给每个图片绑定事件
代理</p> <h3 id="ajax"><a href="#ajax" aria-hidden="true" class="header-anchor">#</a> Ajax</h3> <p>知识点：</p> <ol><li>XMLHttpRequest</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// XMLHttpRequest</span>
<span class="token comment">// IE低版本使用 ActiveXObject</span>
<span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'/api'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>  <span class="token comment">// false说明是异步</span>
xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 这个函数是异步执行的</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">alert</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
</code></pre></div><ol start="2"><li>状态码
readyState:
0:未初始化，还没有调用send()方法
1:载入，已经调用send()方法， 正在发送请求
2:载入完成，send()方法执行完成，已经接收全部响应内容
3:交互，正在解析响应内容
4:完成，响应内容解析完成，可以在客户端调用了
status：
2XX: 成功处理请求，如200
3XX: 需要重定向，浏览器直接跳转
4XX：客户端请求错误，404, 未定义的地址
5XX：服务器端错误，500</li> <li>跨域
前端解决跨域：JSONP
服务器端设置 http header<code>response.setHeader(&quot;Access-Control-Allow-Origin&quot;, &quot;http://a.com, http://b.com&quot;)</code>
跨域：浏览器的同源策略，不允许ajax访问其他域的接口，跨域条件：协议、域名、端口，有一个不同就是跨域
但是有3个标签允许跨域加载资源
<code>&lt;img src=&quot;&quot;&gt;</code> 图片提供方可以做一个防盗链的处理,可以用于大点统计，统计网站可能是其他域
<code>&lt;link href=&quot;&quot;&gt;&lt;/link&gt;</code> 可以用CDN
<code>&lt;script src=&quot;&quot;&gt;&lt;/script&gt;</code>
加载 http://aaa.bbb.com/xxx.html, 服务器不一定真的有一个xxx.html文件, 服务器可以根据请求，动态生成一个文件，返回
同理 <code>&lt;script src=&quot;http://aaa.bbb.com/xxx.html&quot;&gt;&lt;/script&gt;</code></li></ol> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
window<span class="token punctuation">.</span><span class="token function-variable function">callback</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 这是我们跨域得到的信息</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- /该srcipt返回 callback({a: 100, b:200, c: 300}) --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ttp://aaa.bbb.com/xxx.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>题目1: 手动编写一个ajax，不依赖三方库
题目2: 跨域的几种实现方式</p> <h3 id="存储"><a href="#存储" aria-hidden="true" class="header-anchor">#</a> 存储</h3> <p>题目1: 描述一下cookie, sessionStorage 和 localStorage 的区别
cookie: 本身用于客户端和服务器端通信，它本身有本地存储功能是被借用的。
使用 document.cookei = xxx 获取和修改内容
存储量：4KB
所有http请求都带着
sessionStorage 和 localStorage
存储量：5M
setItem(key, value)
getItem(key)
IOS safari隐藏模式下，localStorage.getItem会报错，建议统一使用try-catch封装</p> <h2 id="开发环境"><a href="#开发环境" aria-hidden="true" class="header-anchor">#</a> 开发环境</h2> <p>版本管理--git
模块化
打包工具
上线回滚</p> <h3 id="版本管理"><a href="#版本管理" aria-hidden="true" class="header-anchor">#</a> 版本管理</h3> <h3 id="模块化"><a href="#模块化" aria-hidden="true" class="header-anchor">#</a> 模块化</h3> <h3 id="打包工具"><a href="#打包工具" aria-hidden="true" class="header-anchor">#</a> 打包工具</h3> <h2 id="运行环境"><a href="#运行环境" aria-hidden="true" class="header-anchor">#</a> 运行环境</h2> <p>页面渲染
性能优化</p> <p>浏览器可以通过访问链接来得到页面的内容
通过绘制和渲染，显示出页面的最终样子
整个过程中，我们需要考虑什么问题？</p> <ol><li>页面加载过程</li> <li>性能优化</li> <li>安全性</li></ol> <h3 id="页面渲染"><a href="#页面渲染" aria-hidden="true" class="header-anchor">#</a> 页面渲染</h3> <p>题目 1: 从输入 url 到得到 html 的详细过程
题目 2: window.onload 和 DOMContentLoaded 的区别</p> <ul><li>加载资源的形式
<ul><li>输入 url(或者跳转页面)加载 html（如：http:baidu.com）</li> <li>加载 html 中的静态资源（js 文件，css 文件，图片等等）</li></ul></li> <li>加载一个资源的过程
<ol><li>浏览器根据 DNS 服务器得到域名的 IP 地址</li> <li>向这个 IP 的机器发送一个 http 请求</li> <li>服务器收到，处理并返回 http 请求</li> <li>浏览器得到返回内容</li></ol></li> <li>浏览器渲染页面的过程
<ol><li>根据 html 结构生成一个 DOM Tree</li> <li>根据 css 生成 CSSOM （DOM Tree, 和 CSSOM 都是结构化处理）</li> <li>将 DOM 和 CSSOM 整合成 RenderTree</li> <li>根据 RenderTree 开始渲染和展示</li> <li>遇到<code>&lt;script&gt;</code>时，会执行并阻塞渲染（因为 js 会改变 DOM，所以，js 执行完之后才会继续渲染 RenderTree）</li></ol></li></ul> <p>为什么把 css 文件放在 head 中 ？
因为 html 文件是顺序执行的。如果 css 放在 dom 后面，当渲染 dom 的时候会先按照默认的样式渲染，渲染完后发现还有 css 文件就会再渲染一次。
页面会出现跳动或者卡住的状况，性能太差</p> <p>为什么把 js 文件在 body 后面 ？
因为 js 可以改变 dom 的结构或者内容。js 又是阻塞渲染，放在 html 前面 dom 还没有渲染，无法操作。js 放下面会让页面更快的出来</p> <p>window.onload 和 DOMContentLoaded 的区别 ？
window.onload：是把所有资源全部加载完才会执行，包括图片视频等
DOMContentLoaded：dom 渲染完即可执行，此时图片视频没有加载完</p> <p>window.addEventListener('load', function() {
执行该段 js 文件等的时间较长
})
window.addEventListener('DOMContentLoaded', function() {
执行该段 js 文件等的时间较短
})</p> <h3 id="性能优化"><a href="#性能优化" aria-hidden="true" class="header-anchor">#</a> 性能优化</h3> <ul><li>多使用内存，缓存或者其他方法</li> <li>减少 cpu 计算，减少网络</li></ul> <p>入手：</p> <ul><li>加载页面和静态资源
<ul><li>静态资源的合并压缩（webpack 打包）</li> <li>静态资源缓存</li> <li>使用 CDN 让资源加载更快（在不同区域访问，cnd 会转到就近的地址访问）</li> <li>使用 ssr 后端渲染，数据直接输出到 html 中（而不是前端写页面，在 ajax 请求数据）</li></ul></li> <li>页面渲染
<ul><li>css 放在前，js 放在后面</li> <li>懒加载（图片懒加载，下拉加载更多）</li> <li>减少 dom 查询，对 dom 查询做缓存</li> <li>减少 dom 操作，多个 dam 尽量合并在一起执行</li> <li>事件节流</li> <li>尽早执行操作（DOMContentLoaded）</li></ul></li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- 静态资源缓存：通过链接名称控制缓存，名字变了，链接名称才改变
 &lt;script src=&quot;abc_1.js&quot;&gt;&lt;/srcript&gt; --&gt;</span>

<span class="token comment">&lt;!-- 懒加载：图片，先用一个很小的图片占位，等页面加载好之后用js获取真正的图片地址 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>myImg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>small.png<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-realsrc</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>abc.png<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
	<span class="token keyword">const</span> img1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'myImg'</span><span class="token punctuation">)</span>
	img1<span class="token punctuation">.</span>src <span class="token operator">=</span> img1<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'abc.png'</span><span class="token punctuation">)</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 缓存DOM查询 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
	<span class="token comment">// 没有缓存</span>
	<span class="token keyword">let</span> i
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token comment">// 缓存</span>
	<span class="token keyword">let</span> i
	<span class="token keyword">const</span> pList <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> pList<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 合并DOM插入 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
	<span class="token keyword">const</span> listNode <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">)</span>
	<span class="token comment">// 要插入10个li标签</span>
	<span class="token comment">// createDocumentFragment不会触发dom操作</span>
	<span class="token keyword">const</span> frag <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createDocumentFragment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">let</span> x<span class="token punctuation">,</span> li
	<span class="token keyword">for</span> <span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> x <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> x<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		li <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">)</span>
		li<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">'List item'</span>
		frag<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>li<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	listNode<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>frag<span class="token punctuation">)</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 事件节流 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
	<span class="token keyword">const</span> textarea <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'text'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> timeoutId
	textarea<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'keyup'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	    <span class="token keyword">if</span><span class="token punctuation">(</span>timeoutId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	        <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timeoutId<span class="token punctuation">)</span>
	    <span class="token punctuation">}</span>
	    timeoutId <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	           <span class="token comment">// 连着输入的时候不超过100ms就什么都不管</span>
	    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="安全性"><a href="#安全性" aria-hidden="true" class="header-anchor">#</a> 安全性</h3> <p>XSS：跨站请求攻击，在 input 等输入框中插入 script 脚本，写一段程序，
预防：把 &lt; 替换为 <code>&amp;lt;</code> &gt; 替换为 <code>&amp;gt;</code>，前端替换影响性能，后台替换比较好</p> <p>XSRF：跨站请求伪造，当你在 A 站生成一个订单，别人收到一个有同样订单信息的的图片，点击之后别人就替你付费了
预防：增加验证流程，如指纹，密码，短信验证码</p> <h3 id="面试技巧"><a href="#面试技巧" aria-hidden="true" class="header-anchor">#</a> 面试技巧</h3> <p>简历：
简单明了，重点突出项目经历和解决方案
博客放入简历中，定期维护更新博客
开源项目</p> <p>过程中：
加班就像借钱，救急不救穷
千万不要挑战面试官，不要反考面试官（素质）
遇到不会的问题，说出知道的就可以</p> <h1 id="高级-js-面试"><a href="#高级-js-面试" aria-hidden="true" class="header-anchor">#</a> 高级 js 面试</h1> <h2 id="高级基础"><a href="#高级基础" aria-hidden="true" class="header-anchor">#</a> 高级基础</h2> <p>ES6 常用语法 - Class Module Promise
原型高级应用 - 结合 JQ 和 zepto 源码
异步全面讲解 - 从 JQ 再到 promise
虚拟dom - 存在价值，如何使用，diff算法
vue - MVVM, vue响应式, 模版解析， 渲染
React - 组件化，jsx, vdom, setState
hybrid - 基础，和h5对比，上线流程
通讯 - 通讯原理，JS-Bridge封装</p> <h3 id="es6-常用语法"><a href="#es6-常用语法" aria-hidden="true" class="header-anchor">#</a> ES6 常用语法</h3> <p>题目1: ES6 模块化如何使用，开发环境如何打包</p> <ol><li>模块化的基本语法</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    a<span class="token punctuation">:</span> <span class="token number">100</span>
<span class="token punctuation">}</span>
<span class="token keyword">import</span> utils <span class="token keyword">from</span> <span class="token string">'./utils'</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> fn1 <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>fn1<span class="token punctuation">,</span> a <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./utils'</span>
</code></pre></div><ol start="2"><li>开发环境配置
babel: 将es6转换成es5
webpack: 打包编译，模块化
rollup: 对vue，react等库项目打包</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># babel</span>
<span class="token function">npm</span> init
<span class="token function">npm</span> <span class="token function">install</span> babel-core --save-dev
<span class="token function">npm</span> <span class="token function">install</span> babel-preset-es2015 babel-preset-latest --save-dev  <span class="token comment"># 两个preset</span>
创建.babelrc文件
<span class="token punctuation">{</span>
    <span class="token string">&quot;preset&quot;</span><span class="token keyword">:</span> <span class="token punctuation">[</span><span class="token string">&quot;es2015&quot;</span>, <span class="token string">&quot;latest&quot;</span><span class="token punctuation">]</span>, <span class="token comment"># 最后一个单词是别名</span>
    <span class="token string">&quot;plugins&quot;</span><span class="token keyword">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token function">npm</span> <span class="token function">install</span> babel-cli --global
babel --version
创建 index.js文件
运行 babel ./index.js 编译

<span class="token comment"># webpack</span>
<span class="token function">npm</span> <span class="token function">install</span> webpack webpack-cli babel-loader@7 --save-dev
配置 webpack.config.js

module.exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    entry: <span class="token string">'./src/index.js'</span>,
    output: <span class="token punctuation">{</span>
        path: __dirname,
        filename: <span class="token string">'./build/bundle.js'</span>
    <span class="token punctuation">}</span>,
    module: <span class="token punctuation">{</span>
        rules: <span class="token punctuation">[</span><span class="token punctuation">{</span>
            test: /\.js?$/,
            exclude: /<span class="token punctuation">(</span>node_modules<span class="token punctuation">)</span>/,
            loader: <span class="token string">'babel-loader'</span>
        <span class="token punctuation">}</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

配置 package.json 中的scripts
<span class="token string">&quot;scripts&quot;</span><span class="token keyword">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;start&quot;</span><span class="token keyword">:</span> <span class="token string">&quot;webpack&quot;</span>,
<span class="token punctuation">}</span>
运行 <span class="token function">npm</span> start

<span class="token comment"># rollup , 暂时放弃，报错解决不了</span>
<span class="token function">npm</span> init
<span class="token function">npm</span> i rollup rollup-plugin-node-resolve rollup-plugin-babel --save-dev <span class="token comment"># rollup</span>
<span class="token function">npm</span> i @babel/core babel-plugin-external-helpers babel-preset-latest --save-dev <span class="token comment"># babel</span>
配置 .babelrc
<span class="token punctuation">{</span>
    <span class="token string">&quot;presets&quot;</span><span class="token keyword">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">[</span>
            <span class="token string">&quot;latest&quot;</span>,
            <span class="token punctuation">{</span>
                <span class="token string">&quot;es2015&quot;</span><span class="token keyword">:</span> <span class="token punctuation">{</span>
                    <span class="token string">&quot;modules&quot;</span><span class="token keyword">:</span> <span class="token boolean">false</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">]</span>,
    <span class="token string">&quot;plugins&quot;</span><span class="token keyword">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;external-helpers&quot;</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token comment"># 配置 rollup.config.js</span>

<span class="token function">import</span> babel from <span class="token string">'rollup-plugin-babel'</span>
<span class="token function">import</span> resolve from <span class="token string">&quot;rollup-plugin-node-resolve&quot;</span>

<span class="token function">export</span> default <span class="token punctuation">{</span>
    entry: <span class="token string">'src/index.js'</span>,
    format: <span class="token string">'iife'</span>, <span class="token comment"># amd /  es6 / iife / umd</span>
    plugins: <span class="token punctuation">[</span>
        resolve<span class="token punctuation">(</span><span class="token punctuation">)</span>,
        babel<span class="token punctuation">(</span><span class="token punctuation">{</span>
            exclude: <span class="token string">'node_modules/**'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>,
    dest: <span class="token string">'build/bundle.js'</span>
<span class="token punctuation">}</span>
<span class="token comment"># 配置 package.json</span>
<span class="token string">&quot;scripts&quot;</span><span class="token keyword">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;start&quot;</span><span class="token keyword">:</span> <span class="token string">&quot;rollup -c rollup.config.js&quot;</span>,
    <span class="token string">&quot;test&quot;</span><span class="token keyword">:</span> <span class="token string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span>
<span class="token punctuation">}</span>,
</code></pre></div><ol start="3"><li>js的众多模块化标准
AMD： require.js, CMD：commonjs
ES6: import export</li></ol> <p>题目2: class 与 js 构造函数的区别
new 一个对象，以构造函数为模版创造一个对象。该对象有方法有属性，在构造函数中操作将要创造的新对象就叫this
class 是构造函数的语法糖</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// JS 构造函数</span>
<span class="token keyword">function</span> <span class="token function">Test</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> x<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> y
<span class="token punctuation">}</span>
Test<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>y
<span class="token punctuation">}</span>
<span class="token keyword">const</span> test <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>test<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// class 基本语法</span>
<span class="token comment">// typeof Test // function</span>
<span class="token comment">// Test === Test.prototype.constructor</span>
<span class="token comment">// test.__proto__ === Test.prototype</span>
<span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>
            data<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>hello<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> x
        <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> y
    <span class="token punctuation">}</span>
    <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>y
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> test <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// 继承</span>
<span class="token keyword">function</span> <span class="token function">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">eat</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'animal eat'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Dog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">bark</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'dog bard'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
Dog<span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> hashiqi <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
    <span class="token punctuation">}</span>
    <span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token string">'eat'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Dog</span> <span class="token keyword">extends</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token comment">// 指的就是 Animal, 就是 Animal.prototype.constructor, 只要有extents就要把super() 写上</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
    <span class="token punctuation">}</span>
    <span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token string">'say'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> dog <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token string">'哈士奇'</span><span class="token punctuation">)</span>
dog<span class="token punctuation">.</span><span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
dog<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>题目3: promise 的基本使用和原理
promise解决callback hell
new Promise 实例，而且要return
new promise 时要传入函数，函数有 resolve reject两个函数
成功时执行resolve() 失败时执行reject()
then监听结果</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// promise方法定义</span>
<span class="token keyword">function</span> <span class="token function">loadImg</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span>
        img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">resolve</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        img<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        img<span class="token punctuation">.</span>src <span class="token operator">=</span> src
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// promise方法使用</span>
<span class="token keyword">const</span> src <span class="token operator">=</span> <span class="token string">&quot;http://xxx.png&quot;</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">loadImg</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span>

result<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>img<span class="token punctuation">.</span>width<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'failed'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 可以分步骤写很多个回调函数</span>
result<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>img<span class="token punctuation">.</span>height<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'failed'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>题目4: ES6 其他常用功能</p> <p>let/const
模版变量
解构赋值
块级作用域
函数默认参数
箭头函数（this指向绑定）</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>a<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span> b<span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">,</span> c<span class="token punctuation">:</span> <span class="token number">30</span><span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> a<span class="token punctuation">,</span> b <span class="token punctuation">}</span> <span class="token operator">=</span> obj
<span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">]</span> <span class="token operator">=</span> arr <span class="token comment">// x === arr[0] y === arr[1] z === arr[2]</span>

<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> item <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// var就可以在外部访问到了</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 编译之后为</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> _item <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_item<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token comment">// undefined</span>

<span class="token keyword">function</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span> <span class="token comment">// this指向函数体中最近的一层作用域, 而不是window</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token comment">// { a: 100}</span>
    arr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token comment">// { a: 100 }</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    arr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token comment">// window</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
fn<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">{</span>a<span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="原型高级应用"><a href="#原型高级应用" aria-hidden="true" class="header-anchor">#</a> 原型高级应用</h3> <p>原型如何实际应用</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 使用</span>
<span class="token keyword">var</span> $p <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> $div1 <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#div1'</span><span class="token punctuation">)</span>
<span class="token comment">// css html 是原型方法</span>
$p<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'color'</span><span class="token punctuation">,</span> <span class="token string">'red'</span><span class="token punctuation">)</span>
$p<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
$div1<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'color'</span><span class="token punctuation">,</span> <span class="token string">'blue'</span><span class="token punctuation">)</span>
$div1<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// jq和zepto通过$()方法实例化对象，每个实例都可以从原型中访问到事先定义好的各种方法</span>

<span class="token comment">// zepto(从下往上读)</span>
<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> zepto <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token constant">Z</span> <span class="token punctuation">(</span>dom<span class="token punctuation">,</span> selector<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> i<span class="token punctuation">,</span> len <span class="token operator">=</span> dom <span class="token operator">?</span> dom<span class="token punctuation">.</span>length <span class="token punctuation">:</span> <span class="token number">0</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> dom<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>length <span class="token operator">=</span> len
        <span class="token keyword">this</span><span class="token punctuation">.</span>selector <span class="token operator">=</span> selector <span class="token operator">||</span> <span class="token string">''</span>
    <span class="token punctuation">}</span>
    zepto<span class="token punctuation">.</span><span class="token function-variable function">Z</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>dom<span class="token punctuation">,</span> selector<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 出现了new关键字</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Z</span><span class="token punctuation">(</span>dom<span class="token punctuation">,</span> selector<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    zepto<span class="token punctuation">.</span><span class="token function-variable function">init</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 弱化了源码，只针对原型</span>
        <span class="token keyword">var</span> slice <span class="token operator">=</span> Array<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>slice
        <span class="token keyword">const</span> dom <span class="token operator">=</span> slice<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> zepto<span class="token punctuation">.</span><span class="token constant">Z</span><span class="token punctuation">(</span>dom<span class="token punctuation">,</span> selector<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> <span class="token function-variable function">$</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>seletor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> zepto<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>seletor<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    window<span class="token punctuation">.</span>$ <span class="token operator">=</span> $

    $<span class="token punctuation">.</span>fn <span class="token operator">=</span> <span class="token punctuation">{</span>
        constructor<span class="token punctuation">:</span> zepto<span class="token punctuation">.</span>z<span class="token punctuation">,</span>
        css<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        html<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token string">'html: 这是一个字符串'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token constant">Z</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> $<span class="token punctuation">.</span>fn
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span>
<span class="token comment">// jq</span>
<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> <span class="token function-variable function">jQuery</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">jQuery<span class="token punctuation">.</span>fn<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    jQuery<span class="token punctuation">.</span>fn <span class="token operator">=</span> <span class="token punctuation">{</span>
        css<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'css'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        html<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token number">111</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 定义构造函数</span>
    <span class="token keyword">var</span> init <span class="token operator">=</span> jQuery<span class="token punctuation">.</span>fn<span class="token punctuation">.</span><span class="token function-variable function">init</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> slice <span class="token operator">=</span> Array<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>slice
        <span class="token keyword">const</span> dom <span class="token operator">=</span> slice<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token keyword">var</span> i<span class="token punctuation">,</span> len <span class="token operator">=</span> dom <span class="token operator">?</span> dom<span class="token punctuation">.</span>length <span class="token punctuation">:</span> <span class="token number">0</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> dom<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>length <span class="token operator">=</span> len
        <span class="token keyword">this</span><span class="token punctuation">.</span>selector <span class="token operator">=</span> selector <span class="token operator">||</span> <span class="token string">''</span>
    <span class="token punctuation">}</span>

    init<span class="token punctuation">.</span>prototype <span class="token operator">=</span> jQuery<span class="token punctuation">.</span>fn

    window<span class="token punctuation">.</span>$ <span class="token operator">=</span> jQuery
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span>
</code></pre></div><p>原型如何体现它的扩展性（jq,zepto 插件机制）
为什么要将原型赋值给 $.fn 或者 jQuery.fn ？
因为要扩展插件</p> <div class="language-js extra-class"><pre class="language-js"><code>    <span class="token comment">// 一个简单的插件</span>
    $<span class="token punctuation">.</span>fn<span class="token punctuation">.</span><span class="token function-variable function">getNodeName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>nodeName
    <span class="token punctuation">}</span>
    <span class="token comment">// 给$.fn增加一个新的属性,增加一个新的功能（一个插件）</span>
    <span class="token comment">// 为什么要加在 $ 上面，而不是别的什么内部变量，因为只有$会暴露在window上</span>
    <span class="token comment">// 将插件扩展统一到$.fn.xxx上面</span>
</code></pre></div><h3 id="异步全面讲解"><a href="#异步全面讲解" aria-hidden="true" class="header-anchor">#</a> 异步全面讲解</h3> <p>题目1: 什么是单线程和异步有什么关系</p> <p>单线程：只有一个线程，只能做一件事
原因：避免DOM渲染冲突（解决方案：异步）
浏览器需要渲染DOM,
js可以修改DOM结构
js执行的时候，浏览器DOM渲染会停止
两段js也不能同时执行（都修改DOM就冲突了）
webworker支持多线程，但是不能访问DOM
异步缺点：没有按照书写顺序执行，回调不容易模块化</p> <p>题目2: 什么是 event-loop 事件轮询
异步的实现方案：event-loop
同步代码直接执行，异步函数放在 异步队列 中，同步代码执行完，轮询执行异步队列的函数
异步队列何时被放入：立即被放入，指定一段时间被放入，ajax请求成功之后被放入</p> <p>题目3: 是否用过jQuery的Deferred（延迟）
jq1.5之后推出 Deferred
deferred: 无法改变js异步和单线程本质，只能从写法上杜绝 callback 这种形式，但是解耦了代码（语法糖），体现了开放封闭原则
promise标准: 任何不符合标准的东西，终将会被用户抛弃（全球的项目经理认证）</p> <ol><li>状态变化：pending, fulfilled, rejected
初始状态pending
状态变化：不可逆
pending --&gt; fulfilled
pending --&gt; rejected</li> <li>then
Promise实例必须实现then这个方法
then()必须接收两个函数作为参数，成功失败的回调函数
then()必须返回一个Promise实例，如果没有显式返回，默认就会返回then前面的那个实例</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// jq 1.5之前, 现在也可以这么写，但是1.5之前只支持这么写</span>
<span class="token keyword">var</span> ajax <span class="token operator">=</span> $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    url<span class="token punctuation">:</span> <span class="token string">'data.json'</span><span class="token punctuation">,</span>
    success<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    error<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ajax<span class="token punctuation">)</span> <span class="token comment">// 返回一个 XHR 对象</span>

<span class="token comment">// jq 1.5之后</span>
<span class="token keyword">var</span> ajax <span class="token operator">=</span> $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'data.json'</span><span class="token punctuation">)</span>
ajax<span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">222</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
ajax<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ajax<span class="token punctuation">)</span> <span class="token comment">// 返回一个 deferred 对象</span>

<span class="token comment">// deferred 应用1</span>
<span class="token keyword">var</span> <span class="token function-variable function">wait</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> <span class="token function-variable function">task</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'执行完成'</span><span class="token punctuation">)</span>
        <span class="token comment">// 1</span>
        <span class="token comment">// 2</span>
        <span class="token comment">// 3</span>
    <span class="token punctuation">}</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>task<span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 在执行完task之后，还要进行一些复杂的操作</span>
<span class="token keyword">function</span> <span class="token function">waitHandle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> dtd <span class="token operator">=</span> $<span class="token punctuation">.</span><span class="token function">Deferred</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// 将 Deferred 适量 dtd, 进行一系列封装之后，返回</span>
    <span class="token keyword">var</span> <span class="token function-variable function">wait</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>dtd<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> <span class="token function-variable function">task</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'执行完成'</span><span class="token punctuation">)</span>
            dtd<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token comment">// dtd.reject()</span>
        <span class="token punctuation">}</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span>task<span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> dtd
    <span class="token punctuation">}</span>

    <span class="token comment">// 返回值是 dtd</span>
    <span class="token keyword">return</span> <span class="token function">wait</span><span class="token punctuation">(</span>dtd<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> w <span class="token operator">=</span> <span class="token function">waitHandle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
w<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ok1'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'error1'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
w<span class="token punctuation">.</span> <span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ok2'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'error2'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// dtd的API分为两类，用意不同</span>
第一类：dtd<span class="token punctuation">.</span>resolve dtd<span class="token punctuation">.</span>reject（主动触发）
第二类：dtd<span class="token punctuation">.</span>then dtd<span class="token punctuation">.</span>done dtd<span class="token punctuation">.</span>fail（被动受监听）
这两类要分开，在外部不能主动触发
<span class="token keyword">var</span> w <span class="token operator">=</span> <span class="token function">waitHandle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
w<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 主动执行完之后，后面的then函数将执行失败的回调</span>
w<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ok'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 解决方法 promise(), 不再返回dtd实例，而是返回promise() 里面只有被动触发的方法</span>
<span class="token keyword">function</span> <span class="token function">waitHandle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> dtd <span class="token operator">=</span> $<span class="token punctuation">.</span><span class="token function">Deferred</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">var</span> <span class="token function-variable function">wait</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>dtd<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> <span class="token function-variable function">task</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'执行完成'</span><span class="token punctuation">)</span>
            dtd<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token comment">// dtd.reject()</span>
        <span class="token punctuation">}</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span>task<span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> dtd<span class="token punctuation">.</span><span class="token function">promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 只有被动触发的方法, 外部不能调用resolve，reject</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">wait</span><span class="token punctuation">(</span>dtd<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>题目4: promise 的标准</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 异常捕获</span>
result<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 只处理成功的函数</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 统一捕获异常</span>
    <span class="token comment">// 语法报错，和reject报错都可以捕获</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 多个串联（A请求的结果是B请求的参数）</span>
<span class="token keyword">var</span> resultA <span class="token operator">=</span> <span class="token function">loadImg</span><span class="token punctuation">(</span>src1<span class="token punctuation">)</span>
<span class="token keyword">var</span> resultB <span class="token operator">=</span> <span class="token function">loadImg</span><span class="token punctuation">(</span>src2<span class="token punctuation">)</span>
resultA<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>dataA<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dataA<span class="token punctuation">)</span>
    <span class="token keyword">return</span> resultB
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>dataB<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dataB<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// promise.all() 全部完成, promise.rece() 只有一个完成</span>
<span class="token comment">// Promise.all Promise.rece 接收一个promise对象数组，待全部完成之后统一执行success</span>
Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>result1<span class="token punctuation">,</span> result2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>datas <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>datas<span class="token punctuation">,</span> datas<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> datas<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
Promise<span class="token punctuation">.</span><span class="token function">race</span><span class="token punctuation">(</span><span class="token punctuation">[</span>result1<span class="token punctuation">,</span> result2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>data <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 最先执行完成的data</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>题目5: async/await 的使用(和promise的区别、联系)
then只是将callback拆分了
async/await 是可以用同步的方法写
await 后面必须跟一个Promise实例
需要 babel-polyfill</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> load <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">loadImg</span><span class="token punctuation">(</span><span class="token string">'http://xxx.png'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="框架原理"><a href="#框架原理" aria-hidden="true" class="header-anchor">#</a> 框架原理</h2> <p>虚拟 DOM - 存在价值，如何使用，diff 算法
MVVM vue - MVVM，vue 响应式，模版解析，渲染
组件化 React - 组件化，JSX，vdom， setState</p> <h3 id="虚拟-dom-virtual-dom"><a href="#虚拟-dom-virtual-dom" aria-hidden="true" class="header-anchor">#</a> 虚拟 DOM(virtual dom)</h3> <p>vdom是一类库
vDom: 用js模拟DOM结构，DOM变化的对比放在js层来做（图灵完备的语言），提高重绘性能
图灵完备的语言：能实现各种逻辑的语言，能做到判断、循环、递归，能实现无限循环无限执行的语言，能实现高复杂逻辑的语言，能实现任何数学算法的语言。
题目1: vdom是什么，为何用会存在vdom?
DOM操作是昂贵的，js运行效率高
尽量减少dom操作，不要推到重来</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>ul id<span class="token operator">=</span><span class="token string">&quot;list&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>li <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;item&quot;</span><span class="token operator">&gt;</span>item1<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>li <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;item&quot;</span><span class="token operator">&gt;</span>item2<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>

<span class="token comment">// 用js模拟</span>
<span class="token punctuation">{</span>
    tag<span class="token punctuation">:</span> <span class="token string">'ul'</span><span class="token punctuation">,</span>
    attrs<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        id<span class="token punctuation">:</span> <span class="token string">'list'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    children<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
        tag<span class="token punctuation">:</span> <span class="token string">'li'</span><span class="token punctuation">,</span>
        attrs<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            className<span class="token punctuation">:</span> <span class="token string">'item'</span><span class="token punctuation">,</span> <span class="token comment">// class js的关键字, 所以用className</span>
            children<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Item 1'</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        tag<span class="token punctuation">:</span> <span class="token string">'li'</span><span class="token punctuation">,</span>
        attrs<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            className<span class="token punctuation">:</span> <span class="token string">'item'</span><span class="token punctuation">,</span>
            children<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Item 2'</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment">// 用jq和vDOM分别实现：将一个对象数组展示成一个表格，当修改数组信息，表格也跟着修改。</span>
<span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;container&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token string">&quot;btn-change&quot;</span><span class="token operator">&gt;</span>change<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">'张三'</span><span class="token punctuation">,</span>
    age<span class="token punctuation">:</span> <span class="token number">20</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">'李四'</span><span class="token punctuation">,</span>
    age<span class="token punctuation">:</span> <span class="token number">21</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">'王五'</span><span class="token punctuation">,</span>
    age<span class="token punctuation">:</span> <span class="token number">22</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token comment">/*jq实现*/</span>
<span class="token comment">// 每次改变table的整个都会改变，性能不好</span>
<span class="token comment">// 渲染函数</span>
<span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> $container <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#container'</span><span class="token punctuation">)</span>
    <span class="token comment">// 清空容器</span>
    $container<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
    <span class="token comment">// 拼接table</span>
    <span class="token keyword">var</span> $table <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'&lt;table&gt;'</span><span class="token punctuation">)</span>
    $table<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'&lt;th&gt;&lt;td&gt;name&lt;/td&gt;&lt;td&gt;age&lt;/td&gt;&lt;/th&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    data<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        $table<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`&lt;tr&gt;&lt;td&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/td&gt;&lt;td&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token punctuation">.</span>age<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/td&gt;&lt;/tr&gt;`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">// 渲染到页面</span>
    $container<span class="token punctuation">.</span><span class="token function">addend</span><span class="token punctuation">(</span>$table<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#btn-change'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 修改某一行数据</span>
    data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">30</span>
    data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'朱六'</span>
    <span class="token comment">// 再重新渲染 re-render</span>
    <span class="token function">render</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 页面加载完立即执行（初次渲染）</span>
<span class="token function">render</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
</code></pre></div><p>题目2: vdom 如何使用，核心API是什么？
snabbdom: 一个vdom的技术实现库
h('标签名', {...属性...}, [...子元素...])
h('标签名', {...属性...}, '...')
patch(container, vnode)
patch(vnode, newVnode)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>ul id<span class="token operator">=</span><span class="token string">&quot;list&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>li <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;item&quot;</span><span class="token operator">&gt;</span>item1<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>li <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;item&quot;</span><span class="token operator">&gt;</span>item2<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
<span class="token keyword">var</span> vnode <span class="token operator">=</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'ul#list'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
    <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'li.item'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'Item1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'li.item'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'Item2'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token function">patch</span><span class="token punctuation">(</span>doucment<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'container'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vnode<span class="token punctuation">)</span>
<span class="token keyword">var</span> newVnode <span class="token operator">=</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'ul#list'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
    <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'li.item'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'aaaaa'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'li.item'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'bbbbb'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token function">patch</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> newVnode<span class="token punctuation">)</span> <span class="token comment">// 找出新的vnode和旧的有什么区别，然后替换</span>

<span class="token comment">// 应用</span>
<span class="token comment">// 引入snabbdom文件 有 snabbdom.js snabbdom-class.js snabbdom-props.js snabbdom-style.js snabbdom-eventlist.js h.js 这一堆文件</span>
<span class="token comment">// 引入之后 window.snabbdom就已经有值了</span>
<span class="token keyword">var</span> snabbdom <span class="token operator">=</span> window<span class="token punctuation">.</span>snabbdom
<span class="token comment">// 定义path</span>
<span class="token keyword">var</span> patch <span class="token operator">=</span> snabbdom<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    snabbdom_class<span class="token punctuation">,</span>
    snabbdom_props<span class="token punctuation">,</span>
    snabbdom_style<span class="token punctuation">,</span>
    snabbdom_eventlisteners
<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">// 定义h</span>
<span class="token keyword">var</span> h <span class="token operator">=</span> snabbdom<span class="token punctuation">.</span>h
<span class="token comment">// 生成 vnode</span>
<span class="token keyword">var</span> vnode <span class="token operator">=</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'ul#list'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
    <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'li.item'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'Item1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'li.item'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'Item2'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token function">patch</span><span class="token punctuation">(</span>doucment<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'container'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vnode<span class="token punctuation">)</span>
document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'btn-change'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 生成 newVnode</span>
    <span class="token keyword">var</span> newVnode <span class="token operator">=</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'ul#list'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
        <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'li.item'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'Item1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'li.item'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'bbb'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token function">patch</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> vnode<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">/*重做demo*/</span>
<span class="token keyword">var</span> vnode
<span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> newVnode <span class="token operator">=</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'table'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> tds <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">var</span> i
        <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> item<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                tds<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'td'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> item<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'tr'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> tds<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>vnode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// re-render</span>
        <span class="token function">patch</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> newVnode<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// 初次渲染</span>
        <span class="token function">patch</span><span class="token punctuation">(</span>container<span class="token punctuation">,</span> newVnode<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 存储当前newVode结果</span>
    vnode <span class="token operator">=</span> newVnode
<span class="token punctuation">}</span>

<span class="token comment">// 初次渲染</span>
<span class="token function">render</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token comment">// 更改变化</span>
document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'btn-change'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">30</span>
    data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'朱六'</span>
    <span class="token comment">// re-render</span>
    <span class="token function">render</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>题目3: 了解 diff 算法（vdom 的核心算法）</p> <ol><li>什么是diff算法
linux命令: diff log1.txt log2.txt; 返回两个文件中哪里不一样
git命令: git diff ./index.js; 修改前后的不同
对比两个vDom的异同</li> <li>vdom为何使用diff算法
dom操作要尽量减少，找出必须要更新的，其他不变，找出的过程就要diff算法</li> <li>diff算法的实现流程
patch(container, vnode)
递归，vdom --&gt; 真实的dom节点
patch(vnode, newVnode)
newVnode --&gt; vnode，递归对比，真实的dom节点替换</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// patch(container, vnode)</span>
<span class="token keyword">function</span> <span class="token function">createElement</span><span class="token punctuation">(</span>vnode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> tag<span class="token punctuation">,</span> attrs<span class="token punctuation">,</span> children <span class="token punctuation">}</span> <span class="token operator">=</span> vnode
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>tag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 创建元素</span>
    <span class="token keyword">const</span> elem <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span>
    <span class="token comment">// 属性</span>
    <span class="token keyword">let</span> attrName
    <span class="token keyword">for</span><span class="token punctuation">(</span>attrName <span class="token keyword">in</span> attrs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>attrs<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>attrName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            elem<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span>attrName<span class="token punctuation">,</span> attrs<span class="token punctuation">[</span>attrName<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 子元素</span>
    children<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>childVnode <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// 给elem添加子元素</span>
        <span class="token function">createElement</span><span class="token punctuation">(</span>childVnode<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">// 返回真实的DOM元素</span>
    <span class="token keyword">return</span> elem
<span class="token punctuation">}</span>
<span class="token comment">// patch(vnode, newVnode)</span>
<span class="token comment">// 根节点不会变，递归比较变化</span>
<span class="token keyword">function</span> <span class="token function">updateChildren</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> newVnode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> children <span class="token operator">=</span> vnode<span class="token punctuation">.</span>children <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">const</span> newChildren <span class="token operator">=</span> newVnode<span class="token punctuation">.</span>children <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

    children<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>childVnode<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> newChildVnode <span class="token operator">=</span> newChildren<span class="token punctuation">[</span>index<span class="token punctuation">]</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>childVnode<span class="token punctuation">.</span>tag <span class="token operator">===</span> newChildVnode<span class="token punctuation">.</span>tag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 一样，就深层次对比，递归</span>
            <span class="token function">updateChildren</span><span class="token punctuation">(</span>childVnode<span class="token punctuation">,</span> newChildVnode<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// 不一样，就替换, 替换需要真实的dom节点</span>
            <span class="token function">replaceNode</span><span class="token punctuation">(</span>childVnode<span class="token punctuation">,</span> newChildVnode<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">replaceNode</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> newVnode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 替换需要真实的dom节点</span>
    <span class="token keyword">const</span> elem <span class="token operator">=</span> vnode<span class="token punctuation">.</span>elem
    <span class="token keyword">const</span> newElem <span class="token operator">=</span> <span class="token function">createElement</span><span class="token punctuation">(</span>newVnode<span class="token punctuation">)</span>
    <span class="token comment">// dom替换</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="mvvm-vue"><a href="#mvvm-vue" aria-hidden="true" class="header-anchor">#</a> MVVM vue</h3> <p>BootCDN 引入jq等框架</p> <p>题目1: 使用jq和使用框架的区别（ vue 或者 react ）
数据和视图分离（解耦，开放封闭原则）：jq中都混在一起了，<code>var $li = $('&lt;li&gt;${title}&lt;/li&gt;')</code>, ul只是一个空壳。
以数据驱动视图，只关心数据变化，DOM操作被封装：只改数据，不用管视图。jq是直接干预了dom，vue是只更改数据。DOM操作被封装。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// jq 实现todo-list</span>
<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> name<span class="token operator">=</span><span class="token string">&quot;&quot;</span> id<span class="token operator">=</span><span class="token string">&quot;txt-title&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token string">&quot;btn-submit&quot;</span><span class="token operator">&gt;</span>submit<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>ul id<span class="token operator">=</span><span class="token string">&quot;ul-list&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
<span class="token keyword">const</span> $txtTitle <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#txt-title'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> $btnSubmit <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#btn-submit'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> $ulList <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#ul-list'</span><span class="token punctuation">)</span>
$btnSubmit<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> title <span class="token operator">=</span> $txtTitle<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>title<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> $li <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`&lt;li&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/li&gt;`</span></span><span class="token punctuation">)</span>
    $ulList<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>$li<span class="token punctuation">)</span>
    $txtTitle<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// vue 实现todo-list</span>
<span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;app&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>input v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;title&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>button v<span class="token operator">-</span>on<span class="token punctuation">:</span>click<span class="token operator">=</span><span class="token string">&quot;add&quot;</span><span class="token operator">&gt;</span>submit<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>li v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;item in list&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token keyword">const</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    el<span class="token punctuation">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
    data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        title<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
        list<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        add<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>title<span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">''</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>题目2: 如何理解 MVVM
MVC:
model: 数据
view: 视图，界面
controller： 控制器，逻辑处理
用户 --&gt; view --&gt; controller --&gt; model --&gt; view
用户 --&gt; controller --&gt; model --&gt; view</p> <p>MVVM:
view: 视图、模版（视图和模型是分离的）
model: 数据，模型，js对象
vm: viewModel, vue实例，链接view、model。view 通过事件监听操作model(v-on 和 methods), model通过数据绑定来操作view
MVVM三要素:</p> <ol><li>响应式：vue如何监听到data的每个属性变化？ 我们只是 this.title = '' this.list.push(this.title)</li> <li>模版引擎：vue的模版如何被解析，指令如何处理？模版中并不是真正的html</li> <li>渲染：vue的模版如何被渲染成html? 以及渲染过程。</li></ol> <p>题目3: vue 如何实现响应式
关键是 Object.defineProperty
将data的属性代理到vm上</p> <ol><li>什么是响应式？
修改data属性后，vue立刻监听到
data属性被代理到 vm 上</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// data.name, 被代理到vm上了, vm.name 就是data.name</span>
<span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    el<span class="token punctuation">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
    data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">'lyr'</span><span class="token punctuation">,</span>
        age<span class="token punctuation">:</span> <span class="token number">20</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ol start="2"><li>Object.defineProperty IE9以上</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 将对象属性到获取和设置都变成函数, 对象被访问时可以监听到，被设置到时候可以监听到</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> _name <span class="token operator">=</span> <span class="token string">'lyr'</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token keyword">get</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'get'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> _name
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">set</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>newVal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'set'</span><span class="token punctuation">)</span>
        _name <span class="token operator">=</span> newVal
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// 可以监听到</span>
obj<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'李月茹'</span> <span class="token comment">// 可以监听到</span>
</code></pre></div><ol start="3"><li>模拟</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 模拟vue怎么监听name,age</span>
<span class="token comment">// var vm = new Vue({</span>
<span class="token comment">//     el: '#app',</span>
<span class="token comment">//     data: {</span>
<span class="token comment">//         name: 'lyr',</span>
<span class="token comment">//         age: 20</span>
<span class="token comment">//     }</span>
<span class="token comment">// })</span>

<span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
    age<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    name<span class="token punctuation">:</span> <span class="token string">'lyr'</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> key<span class="token punctuation">,</span> value
<span class="token keyword">for</span><span class="token punctuation">(</span>key <span class="token keyword">in</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 命中闭包，新建一个函数，保证key的独立作用域</span>
    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 将data属性代理到vm上, data是实例化的时候传进来到参数</span>
        Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
            <span class="token keyword">get</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'get'</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> data<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token keyword">set</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>newVal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'set'</span><span class="token punctuation">)</span>
                data<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> newVal
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>题目4: vue 如何解析模版</p> <ol><li>模版是什么？
本质: 字符串
有逻辑: 如 v-if v-for等
与html格式很像, 但是有很大区别（html是静态的，没有逻辑）
最终要转换为html来显示
模版最终必须转化成js代码，因为：有逻辑（v-if v-for）必须使用js才能实现（图灵完备）；转换成html渲染页面，必须用js才能实现；因此模版最重要要转换成一个js函数（render函数）</li></ol> <ul><li>模版：字符串，有逻辑，嵌入js变量...</li> <li>模版必须转换成js代码（有逻辑，渲染html，js变量）</li> <li>render函数什么样子</li> <li>render函数执行返回vnode</li> <li>updateComponent</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// with的用法</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">'lyr'</span><span class="token punctuation">,</span>
    age<span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
    getAddress<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'aaa'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 不用with</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>age<span class="token punctuation">)</span>
    obj<span class="token punctuation">.</span><span class="token function">getAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 使用with, with有解构的作用</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">with</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span>
        <span class="token function">getAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>render函数
模版中所有信息都包含在render函数中
this即vm
price 即this.price即vm.price，即data中的price
_c即this._c即vm._c</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;app&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>price<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

<span class="token comment">// 模版最终转化为</span>
<span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">with</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// this就是vm这个vue实例，_c === vm._c; _v === vm._v; _s === vm._s</span>
        <span class="token keyword">return</span> <span class="token function">_c</span><span class="token punctuation">(</span>
            <span class="token string">'div'</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                attrs<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;app&quot;</span><span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span>
                <span class="token function">_c</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token function">_v</span><span class="token punctuation">(</span><span class="token function">_s</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// _s 就是toString, _v创建文本节点，_c创建标签</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 从哪里可以看到render函数: 源码中搜索code.render, 打印,就可以找到模版的render函数</span>
<span class="token comment">// 复杂一点儿的例子，render函数是什么样子的</span>
<span class="token comment">// v-if v-for v-on都是怎么处理的</span>
<span class="token comment">// vue2.0开始支持预编译，开发环境写模版，经过工具编译打包，生产环境就是js代码，即上面的render函数。</span>
<span class="token comment">// react 组件化 jsx模版，经过编译生成js代码，jsx语法已经标准化。</span>
    <span class="token keyword">with</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">_c</span><span class="token punctuation">(</span>
            <span class="token string">'div'</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                attrs<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;app&quot;</span><span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span>
                <span class="token function">_c</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
                    <span class="token function">_c</span><span class="token punctuation">(</span>
                        <span class="token string">'input'</span><span class="token punctuation">,</span>
                        <span class="token punctuation">{</span>
                            directives<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
                                name<span class="token punctuation">:</span> <span class="token string">'model'</span><span class="token punctuation">,</span>
                                rawName<span class="token punctuation">:</span> <span class="token string">'v-model'</span><span class="token punctuation">,</span>
                                value<span class="token punctuation">:</span> <span class="token punctuation">(</span>title<span class="token punctuation">)</span><span class="token punctuation">,</span>
                                expression<span class="token punctuation">:</span> <span class="token string">'title'</span>
                            <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            domProps<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                                value<span class="token punctuation">:</span> <span class="token punctuation">(</span>title<span class="token punctuation">)</span>
                            <span class="token punctuation">}</span><span class="token punctuation">,</span>
                            on<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                                input<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>$event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                                    <span class="token keyword">if</span><span class="token punctuation">(</span>$event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                                        <span class="token keyword">return</span> title <span class="token operator">=</span> $event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value <span class="token comment">// vm.title = $event.target.value</span>
                                    <span class="token punctuation">}</span>
                                <span class="token punctuation">}</span>
                            <span class="token punctuation">}</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token function">_v</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token function">_c</span><span class="token punctuation">(</span><span class="token string">&quot;button&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                        on<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                            click<span class="token punctuation">:</span> add <span class="token comment">// vm.add</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token function">_v</span><span class="token punctuation">(</span><span class="token string">'submit'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token function">_v</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token function">_c</span><span class="token punctuation">(</span><span class="token string">&quot;div&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
                    <span class="token function">_c</span><span class="token punctuation">(</span><span class="token string">'ul'</span><span class="token punctuation">,</span> <span class="token function">_l</span><span class="token punctuation">(</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// vm._l 是个for循环</span>
                        <span class="token keyword">return</span> <span class="token function">_c</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token function">_v</span><span class="token punctuation">(</span><span class="token function">_s</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre></div><ol start="3"><li>render函数和vdom
vdom核心API: h函数，patch函数
vm._c其实相当于 snabbdom 中的h函数
render函数执行之后返回的是 vnode
updateComponent 实现了vdom的patch, 新旧对比
页面首次渲染执行updateComponent
data每次修改都执行updateComponent</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">updateComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// vm._render 即上面的render函数，返回 vnode</span>
    vm<span class="token punctuation">.</span><span class="token function">_update</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span><span class="token function">_render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
vm<span class="token punctuation">.</span><span class="token function">_update</span><span class="token punctuation">(</span>vnode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> prevVnode <span class="token operator">=</span> vm<span class="token punctuation">.</span>_vnode
    vm<span class="token punctuation">.</span>_vnode <span class="token operator">=</span> vnode
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>prevVnode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        vm<span class="token punctuation">.</span>$el <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">__patch__</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>$el<span class="token punctuation">,</span> vnode<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        vm<span class="token punctuation">.</span>$el <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">__patch__</span><span class="token punctuation">(</span>prevVnode<span class="token punctuation">,</span> vnode<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>题目5: 介绍 vue 的实现流程
第一步: 解析模版成render函数（h 函数）</p> <ul><li>模版打包的时候就解析成render函数了, 创建vnode的过程，添加属性，事件，解析指令等等。</li> <li>with的用法</li> <li>模版中的所有信息都被render函数包含</li> <li>模版中用到的data中的属性，都变成了js变量</li> <li>模版中的v-model v-for v-on 都变成了js逻辑</li> <li>render 函数返回 vnode
第二步: 响应式开始监听</li> <li>Object.defineProperty</li> <li>将data的属性代理到vm上（with）
第三步: 首次渲染，显示页面，且绑定依赖</li> <li>初次渲染，执行updateComponent执行vm.render()</li> <li>执行render函数，会访问到vm.list vm.title</li> <li>会被响应式的get方法监听到，为什么不监听set（data中有很多属性，用到到走get，没用到不走。未走get的属性，set的时候也无需关心，避免不必要到重复渲染）</li> <li>执行updateComponent,会走到vdom的patch方法</li> <li>patch将vnode渲染成DOM, 初次渲染完成
第四步: data属性变化，触发rerender</li> <li>修改属性<code>this.title = 'aaa'</code>，被响应式的set监听</li> <li>set中执行 updateComponent</li> <li>updateComponent 重新执行vm._render()</li> <li>生成vnode和preVnode，通过patch进行对比</li> <li>渲染到html中</li></ul> <h3 id="组件化-react"><a href="#组件化-react" aria-hidden="true" class="header-anchor">#</a> 组件化 React</h3> <p>react以及组件化的一些核心概念
react的实现流程</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// to-do-list</span>
<span class="token keyword">class</span> <span class="token class-name">List</span> <span class="token keyword">extends</span> <span class="token class-name">component</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>data
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>
            <span class="token punctuation">{</span>
                list<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token punctuation">{</span>index<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>item<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Input</span> <span class="token keyword">extends</span> <span class="token class-name">component</span> <span class="token punctuation">{</span>
    state <span class="token operator">=</span> <span class="token punctuation">{</span>
        title<span class="token punctuation">:</span> <span class="token string">''</span>
    <span class="token punctuation">}</span>
    <span class="token function">changeValue</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            title<span class="token punctuation">:</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">addTitle</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>title<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            title<span class="token punctuation">:</span> <span class="token string">''</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span> title <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>input value<span class="token operator">=</span><span class="token punctuation">{</span>title<span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>changeValue<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>submit<span class="token punctuation">}</span><span class="token operator">&gt;</span>submit<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Todo</span> <span class="token keyword">extends</span> <span class="token class-name">component</span> <span class="token punctuation">{</span>
    state <span class="token operator">=</span> <span class="token punctuation">{</span>
        list<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    <span class="token function">addTitle</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> currentList <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>list
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            list<span class="token punctuation">:</span> currentList<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span> list <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>Input addTitle<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>addTitle<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Input<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>List data<span class="token operator">=</span><span class="token punctuation">{</span>list<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>List<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>题目1: 对组件化的理解</p> <ol><li>封装
把视图，数据,变化逻辑（数据驱动视图变化）封装起来：把我要的数据给我，其他就不用管了</li> <li>复用
props 传递数据: 不同的config展示不同的效果，复用</li></ol> <p>题目2: jsx 是什么
jsx和vue的模版一样，最终要渲染成html
jsx语法无法被浏览器解析
jsx解析成js才能运行
jsx成为一个独立到标准：说明本身功能已经完备，和其他标准兼容，扩展性没有问题</p> <p>jsx其实是语法糖，开发环境将jsx编写成js代码，jsx的写法降低了学习成本和编码工作量，但是加大了debug工作量</p> <p>编译jsx为js的插件
插件：<code>npm i --save-dev babel-plugin-transform-react-jsx</code>
配置 .babelrc：<code>{ &quot;plugins&quot;: [&quot;transform-react-jsx&quot;]}</code>
执行命令：<code>babel --plugins transform-react-jsx demo.jsx</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// jsx</span>
<span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">&quot;avatar.png&quot;</span> className<span class="token operator">=</span><span class="token string">&quot;profile&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h3<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">[</span>user<span class="token punctuation">.</span>firstName<span class="token punctuation">,</span> user<span class="token punctuation">.</span>lastName<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h3<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token comment">// jsx会解析成</span>
React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>id<span class="token punctuation">:</span> <span class="token string">'div1'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> child1<span class="token punctuation">,</span> child2<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">)</span>
React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>id<span class="token punctuation">:</span> <span class="token string">'div1'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> src<span class="token punctuation">:</span> <span class="token string">'avatar.png'</span><span class="token punctuation">,</span> className<span class="token punctuation">:</span> <span class="token string">'profile'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'h3'</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>user<span class="token punctuation">.</span>firstName<span class="token punctuation">,</span> user<span class="token punctuation">.</span>lastName<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'ul'</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>key<span class="token punctuation">:</span> index<span class="token punctuation">}</span><span class="token punctuation">,</span> item<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// 所以，react组件中必须引入React</span>
</code></pre></div><p>题目3: jsx 和 vdom 的关系
为何需要vdom: jsx就是模版，最终要渲染成html，数据驱动视图，需要用vdom的方式渲染
React.createElement 和 h 都生成vnode, h函数第一次渲染是一个dom节点，React.createElement还可以是自定义组件
何时 patch：初次渲染 ReactDOM.render + 修改state后的re-render（正好符合vdom的应用场景）</p> <ul><li>初次渲染 - <code>ReactDOM.render(&lt;App /&gt;, container)</code>, 会触发<code>patch(container, vnode)</code>, <code>container === decument.getElementById('app')</code></li> <li>rerender - setState, 会触发 <code>patch(vnode, newVnode)</code></li></ul> <p>自定义组件的解析
自定义组件编译，第一个传入的是构造函数。
初始化实例然后执行render</p> <ul><li>div直接渲染成<code>&lt;div&gt;</code>即可，vdom可以做到</li> <li>自定义组件（class）,vdom默认不认识</li> <li>因此，Input等自定义组件组件定义的时候必须声明render函数</li> <li>根据props初始化实例，然后执行实例的render函数。render函数返回的还是vnode对象</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Input <span class="token keyword">from</span> <span class="token string">'./input/index.js'</span>
<span class="token keyword">import</span> List <span class="token keyword">from</span> <span class="token string">'./List/index.js'</span>
<span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span> list <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>Input addTitle<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>addTitle<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Input<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>List data<span class="token operator">=</span><span class="token punctuation">{</span>list<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>List<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 编译为</span>
<span class="token keyword">import</span> Input <span class="token keyword">from</span> <span class="token string">'./input/index.js'</span>
<span class="token keyword">import</span> List <span class="token keyword">from</span> <span class="token string">'./List/index.js'</span>
<span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
        React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'Input'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>addTitle<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>addTitle<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
        React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'List'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>data<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>list<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'List'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>data<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>list<span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token comment">// 等价于</span>
<span class="token keyword">var</span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token punctuation">(</span><span class="token punctuation">{</span>data<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>list<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// 生成实例，返回实例的render函数</span>
<span class="token keyword">var</span> vnode <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 每个组件都返回一个render函数，不管有多少层组件，都会一层一层的执行render函数，最终转化成html</span>
</code></pre></div><p>题目4: 简述 setState 的过程</p> <p>setState的异步（为什么需要异步）</p> <ol><li>可能会一次执行多次setState。</li> <li>你无法规定，限制用户如何使用setState</li> <li>没有必要每次setState都重新渲染，考虑性能</li> <li>即便是每次重新渲染，用户也看不到中间效果（js执行的时候，dom渲染是停止的）
vue修改属性也是异步
set中执行updateComponent是异步的</li></ol> <p>setState的过程</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// setState的异步</span>
<span class="token function">addTitle</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> currentList <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>list
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>list<span class="token punctuation">)</span> <span class="token comment">// []</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token comment">// 异步</span>
        list<span class="token punctuation">:</span> currentList<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>list<span class="token punctuation">)</span> <span class="token comment">// []</span>
<span class="token punctuation">}</span>

<span class="token function">addTitle</span><span class="token punctuation">(</span>title <span class="token operator">=</span> <span class="token string">'aaa'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> currentList <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>list
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        list<span class="token punctuation">:</span> currentList<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        list<span class="token punctuation">:</span> currentList<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>title <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        list<span class="token punctuation">:</span> currentList<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>title <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>list<span class="token punctuation">)</span> <span class="token comment">// [aaa2], 直接执行最后一个，前面两个没有执行</span>
<span class="token punctuation">}</span>

<span class="token comment">// setState的过程</span>
<span class="token function">addTitle</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> currentList <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>list
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token comment">// 异步</span>
        list<span class="token punctuation">:</span> currentList<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// 每个组件都extend React.Component, Component父类中定义的方法</span>
        <span class="token comment">// setState中会默认执行这个回调</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">renderComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 模拟Component</span>
<span class="token keyword">class</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token function">renderComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> prevVnode <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_vnode
        <span class="token keyword">const</span> newVnode <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">patch</span><span class="token punctuation">(</span>prevVnode<span class="token punctuation">,</span> newVnode<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_vnode <span class="token operator">=</span> newVnode
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>题目5: 如何比较 react 和 vue
两者的本质区别：</p> <ul><li>vue - 本质是 MVVM 框架，由 MVC 发展而来</li> <li>React - 本质是前端组件化框架，由后台组件化发展而来
看模版和组件化的区别：</li> <li>vue - 使用模版（最初由angular提出）</li> <li>React - 使用JSX（已经标准化）</li> <li>模版语法上 - 更倾向 jsx, JSX只有一个规则，大括号中可以放变量表达式</li> <li>模版分离上 - 更倾向 vue, react中模版和js混合在一起，未分离</li> <li>react组件化 - react本身就是组件化，没有组件化就不是react</li> <li>vue组件化 - vue也支持组件化，不过是在MVVM上的扩展
两者的共同点：</li> <li>都支持组件化</li> <li>都是数据驱动视图
选型：
国内使用，首推vue。文档易读易学，社区够大
团队水平较高，推荐react。组件化和jsx</li></ul> <h2 id="app-混合开发"><a href="#app-混合开发" aria-hidden="true" class="header-anchor">#</a> app 混合开发</h2> <p>hybrid - 基础，和 H5 的对比，上线流程（前端和 APP 一起开发）
前端客户端通讯：通讯原理，JS-Bridge 封装</p> <h3 id="hybrid"><a href="#hybrid" aria-hidden="true" class="header-anchor">#</a> hybrid</h3> <p>APP 中都要内嵌很多页面
server 和客户端要了解
对协议和标准要特别重视</p> <p>使用场景
NA：体验要求极致，变化不频繁（如头条的首页）
hybrid: 体验要求高，变化频繁（头条的新闻详情页）
h5:体验无要求，不常用（如举报，反馈等）</p> <ol><li>hybrid 是什么，为何用 hybrid ？
快速迭代，无需审核</li></ol> <ul><li><p>实现</p> <ul><li>前端做好静态页面，将文件交给客户端；</li> <li>客户端将之以文件的形式存进 app 中；</li> <li>客户端在一个 webview 中使用 file 协议加载静态页面</li></ul></li> <li><p>优点</p> <ul><li>快速的迭代更新，无需 app 审核，因为原生的开发可以拿到地理位置，用户信息等高权限的信息，所以要审核</li> <li>体验更流畅，和 NA 基本一致</li> <li>减少开发成本，双端一套代码</li></ul></li> <li><p>webview（小浏览器） ？</p> <ul><li>是 app 的一个组件，app 可以有 webview，也可以没有。</li> <li>用于加载 h5 页面，即一个小型的浏览器内核</li></ul></li> <li><p>file 协议</p> <ul><li>file 协议(file://)：加载本地的文件是 ，快，hybrid 要用 file 协议。</li> <li>http 协议(http://)：网络加载，慢</li></ul></li></ul> <ol start="2"><li>hybrid 如何更新上线 ？</li></ol> <ul><li>如何更新每个手机上 app 的本地文件：用户每次打开 app，客户端都去 server 下载最新的静态文件（我们，分版本号，压缩文件上传）</li></ul> <ol start="3"><li>hybrid 和 h5 有何区别 ？</li></ol> <ul><li><p>hybrid:</p> <ul><li>体验要求高，变化频繁（头条的新闻详情页）</li> <li>开发成本高，联调，测试，查 bug 都比较麻烦</li> <li>运维成本高</li></ul></li> <li><p>h5:体验无要求，不常用（如举报，反馈等，单次用的）</p></li></ul> <ol start="4"><li>js 如何与客户端如何通信 ？
js 和客户端通讯的基本形式：调用能力，传递参数，监听回调。（webview ---参数，callback--&gt; 客户端）
schema 协议:用于前端和客户端的通讯的约定,每个 app 的 schema 都不同，可以自己定义</li></ol> <ul><li><p>前置问题</p> <ul><li>微信的 js-sdk： 前端和客户端的一个中间层，让 html 可以调用手机底层的东西（微信公众号等中使用）</li> <li>js 和客户端通讯的基本形式 （webview ---参数，callback--&gt; 客户端）</li> <li>schema 协议简介和使用</li> <li>schema 使用的封装</li> <li>内置上线：黑客看不到协议</li></ul></li> <li><p>新闻详情页适用 hybrid，前端如何获取新闻内容 ？</p> <ul><li>不能用 ajax 获取。第一跨域，第二速度慢</li> <li>客户端获取新闻内容，然后 js 通讯拿到内容，再渲染</li> <li>客户端可以提前获取</li></ul></li></ul> <h3 id="前端客户端通讯"><a href="#前端客户端通讯" aria-hidden="true" class="header-anchor">#</a> 前端客户端通讯</h3> <h1 id="js-基本知识点"><a href="#js-基本知识点" aria-hidden="true" class="header-anchor">#</a> js 基本知识点</h1> <h2 id="js-概观"><a href="#js-概观" aria-hidden="true" class="header-anchor">#</a> js 概观</h2> <ul><li><p>一种基于对象和事件驱动的客户端脚本语言。</p></li> <li><p>注释：<code>// , /\*\*/</code></p></li> <li><p>变量：区分大小写。声明变量：var</p></li> <li><p>标识符：变量，函数，属性的名字，或者函数的参数。</p> <ul><li>组成规则：
<ul><li>字母、数字、下划线或$构成;</li> <li>不能数字开头</li> <li>不能用关键字和保留字</li></ul></li></ul></li> <li><p>数据类型：</p> <ul><li>undefined，null（空指针，准备放对象），boolean，number（NaN）,string， object，symbol</li> <li>NaN:和任何值都不相等，任何涉及 NaN 的操作(NaN/10)都返回 NaN</li></ul></li> <li><p>操作符：</p> <ul><li>typeof 语法：typeof(变量);</li> <li>返回值：string 类型，可能是 string、number、Boolean、object、undefined、function</li></ul></li> <li><p>方法：</p> <ul><li>number
<ul><li>isNaN(n):判断一个参数是否是非数字，返回 true,false</li> <li>Number(a):把非数字转为数字</li> <li>parseInt(a):把非数字转为数字(转换空字符串返回 NaN，提供两个参数 parseInt(&quot;0f0&quot;, 16))</li> <li>parseFloat(a):把非数字转为数字(第一个点有效，其余无效)</li></ul></li> <li>string
<ul><li>String():将任何类型转为字符串</li> <li>str.toString():将 str 转换为字符串，返回 str 的一个副本，将它赋给变量</li></ul></li></ul></li> <li><p>类型转换：</p> <ul><li>转为 Boolean</li> <li>0 之外的数字都 true;</li> <li>&quot; &quot;之外的字符都为 true;</li> <li>null,undefined 都为 false;</li></ul></li></ul> <h2 id="表达式和操作符"><a href="#表达式和操作符" aria-hidden="true" class="header-anchor">#</a> 表达式和操作符</h2> <ul><li><p>表达式：将同种类型的数据（常量，变量，函数等）用运算符按一定的规则连起来</p></li> <li><p>操作符：</p> <ul><li><p>算数操作符：返回的类型都是 number</p> <ul><li>++a: a = a + 1;</li> <li>a++:</li></ul></li> <li><p>逻辑操作符：</p> <ul><li>赋值操作符：= , += , -= , *= , /= , %= ;</li> <li>比较操作符：</li> <li>三元操作符：条件 ？执行代码 1 ：执行代码 2（如果条件成立执行 1，否则执行 2）</li> <li>&amp;&amp; || !</li></ul></li></ul></li></ul> <h2 id="语句"><a href="#语句" aria-hidden="true" class="header-anchor">#</a> 语句</h2> <div class="language-js extra-class"><pre class="language-js"><code>    <span class="token keyword">if</span><span class="token punctuation">(</span>boolean<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>表达式<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>表达式<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token comment">// let val = prompt('请输入'); // 有返回结果。带确定按钮，点取消，值为null</span>
    <span class="token comment">// new Date().getDay() // 获取星期，返回值number(0-6),周日是0</span>

    <span class="token keyword">switch</span><span class="token punctuation">(</span>判断某个变量<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> value<span class="token punctuation">:</span>
            document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'dddd'</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> value1<span class="token punctuation">:</span>
        <span class="token keyword">case</span> value2<span class="token punctuation">:</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'aaa'</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token punctuation">:</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'dfskdfsk'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span>语句<span class="token number">1</span><span class="token punctuation">;</span>语句<span class="token number">2</span><span class="token punctuation">;</span>语句<span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 被执行代码 <span class="token punctuation">}</span>
    <span class="token comment">// 语句1：循环代码块开始前执行</span>
    <span class="token comment">// 语句2：代码块循环条件</span>
    <span class="token comment">// 语句3：代码块执行后执行</span>
    <span class="token comment">// for嵌套：外层为假时内层不执行；先执行外层再执行内层，直到内层条件为假时再返回外层执行</span>
    <span class="token comment">// for适合已知循环次数的循环体，while适合未知</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>条件<span class="token punctuation">)</span> <span class="token punctuation">{</span> 被执行代码 <span class="token punctuation">}</span>
    <span class="token comment">//至少要执行一次</span>
    <span class="token keyword">do</span> <span class="token punctuation">{</span> 被执行代码 <span class="token punctuation">}</span> <span class="token keyword">while</span><span class="token punctuation">(</span>j <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span>

    <span class="token keyword">break</span>：彻底退出循环体
    <span class="token keyword">continue</span>：结束本次循环，继续下一次

    <span class="token comment">// 打印所有0-50之间除20之外的5的倍数</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">===</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">continue</span> <span class="token comment">// 本次循环不执行</span>
        <span class="token punctuation">}</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre></div><h2 id="函数"><a href="#函数" aria-hidden="true" class="header-anchor">#</a> 函数</h2> <ul><li>定义：function 函数名([参数]) { 可执行代码 }</li> <li>调用：函数名([参数])</li> <li>返回值：return</li> <li>参数：
<ul><li>arguments 在函数内部参数是由一个叫 arguments 的类数组管理的。</li> <li>可用[]来访问每一个参数（0 开始的索引），</li> <li>还有一个 length 属性来确定参数个数</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">arrAvg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">let</span> sum <span class="token operator">=</span> <span class="token number">0</span>
	<span class="token keyword">let</span> i
	<span class="token keyword">const</span> len <span class="token operator">=</span> arguments<span class="token punctuation">.</span>length
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		sum <span class="token operator">+=</span> arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> sum <span class="token operator">/</span> len
<span class="token punctuation">}</span>
<span class="token comment">// 有返回必须有接收</span>
<span class="token keyword">const</span> req <span class="token operator">=</span> <span class="token function">arrAvg</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="内置对象"><a href="#内置对象" aria-hidden="true" class="header-anchor">#</a> 内置对象</h2> <ul><li><p>Array
创建
const test = new Array(10);如果知道长度就写上
[{name: 1111}, 'dddd']// 字面量,可以保存任意类型的值
读取
['aaa', 'bbb', 'ccc'][1] // 'bbb'
赋值
test[0] = 1
test[1] = 'ddd'
长度
arr.length // number
arr.length = 3 // 长度超过 3 的被删除。通过设置 length 可以从数组的末尾移除项或者向数组中添加新项
arr[99] = 'xxx' // 长度为 100
栈方法
push() // 在数组尾部顺序添加 1 或多个值，返回值为新的长度 number
unshift() // 在数组开头添加 1 或多个值，返回值为新的长度 number
pop() // 删除数组最后一个元素，返回值为删除的那个元素
shift() // 删除开头的值，返回值为删除的那个元素
转换方法
join() // 将数组转换为字符串，返回值为字符串。无参数默认用逗号隔开。参数为分隔符。
可以用''分开
reverse() // 颠倒数组中元素的顺序
sort() // 对数组里的元素排序，返回值是排序后的数组。
可以接收一个比较函数作为参数
即使数组中每一项都是数值，sort()比较的也是字符串（比较的是字符串）
arr.sort((a, b) =&gt; a-b)
连接和截取
arr1.concat(arr2, arr3 ……) // 返回值为连接好的新数组
arr.slice(start, [end]) // 从已有的数组中返回选定的元素(start,end 是数组的下标，截取的元素不包含 end)
无 end,则从 start 到结束。
slice 有一个负数，则该处的索引即为：数组长度加上该数</p> <pre><code>  // const a = [1, 3, 4]
  实现b数组对a数组的拷贝
  b = [].concat(a) // 性能较高
  b = a.slice(0)
</code></pre> <p>删除、插入和替换</p></li> <li><p>String</p></li> <li><p>Math</p></li> <li><p>Date</p></li></ul> <h2 id="dom-基础"><a href="#dom-基础" aria-hidden="true" class="header-anchor">#</a> DOM 基础</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 查找</span>

<span class="token comment">// 可以是document也可以是别的DOM元素</span>
<span class="token keyword">const</span> box <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'box'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> tags <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">)</span> <span class="token comment">// 返回数组</span>
<span class="token keyword">const</span> ulLi <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'list1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">)</span>

<span class="token comment">// 设置样式</span>
ele<span class="token punctuation">.</span>style<span class="token punctuation">.</span>styleName <span class="token operator">=</span> styleValue
box<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'#f00'</span>
box<span class="token punctuation">.</span>style<span class="token punctuation">.</span>fontWeight <span class="token operator">=</span> <span class="token string">'bold'</span>
<span class="token comment">// ele: dom元素</span>
<span class="token comment">// styleName：样式名称,驼峰</span>
<span class="token comment">// styleValue： 样式值</span>

<span class="token comment">// 属性</span>
ele<span class="token punctuation">.</span>innerHTML <span class="token comment">// 获取ele元素开始标签和结束标签之间的HTML和文本内容</span>
ele<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">''</span> <span class="token comment">// 设置</span>
ele<span class="token punctuation">.</span>className <span class="token comment">// 获取ele元素的class属性</span>
ele<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">'cls'</span> <span class="token comment">// 设置ele元素的class属性 （如果之前有，会替换）</span>
<span class="token comment">// 操作属性</span>
ele<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'attribute'</span><span class="token punctuation">)</span> <span class="token comment">// attribute:要获取的html属性，如id，type</span>
<span class="token comment">// 如果是DOM元素（标签）自带的属性直接用点获取：box.id, box.align。class除外，用box.className</span>
<span class="token comment">// 如果是你自己设置的用getAttribute(&quot;attribute&quot;)方法</span>
ele<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'attribute'</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token comment">// 有兼容性</span>
<span class="token comment">// attribute:要设置的属性名</span>
<span class="token comment">// value为attribute的值,如果是字符串要加引号</span>
box<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'isRight'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
ele<span class="token punctuation">.</span><span class="token function">removeAttribute</span><span class="token punctuation">(</span><span class="token string">'attribute'</span><span class="token punctuation">)</span> <span class="token comment">// attribute：要删除的属性名称</span>
</code></pre></div><h2 id="dom-事件"><a href="#dom-事件" aria-hidden="true" class="header-anchor">#</a> DOM 事件</h2> <ul><li><p>事件：文档或浏览器窗口中发生的一些特定的交互瞬间</p> <ul><li><p>HTML 事件：</p> <pre><code>      &lt;tag 事件=&quot;执行脚本&quot;&gt;&lt;/tag&gt;
          // 在HTML元素上绑定事件
          // “执行脚本”可以是一个函数的调用，一定要加括号
          // 在事件触发的函数中，this是对该DOM对象的引用
          // &lt;div onmouseover=&quot;fn(this)&quot; onmouseout=&quot;out(this, '#00f')&quot;&gt;&lt;/div&gt;
              function fn(_this) { _this就是DOM本身 }
</code></pre></li> <li><p>DOM0 级事件：先获取 DOM 然后在 DOM 对象上绑定事件</p> <pre><code>      ele.事件 = 执行脚本

          // 执行脚本可以是一个匿名函数也可是一个函数的调用
          // const btn = document.getElementById(&quot;btn&quot;)
          // btn.onClick = function() {
              // 给按钮绑定事件，this是对该DOM元素的引用
              if(this.className===&quot;box1&quot;) {
                  this.className = &quot;box2&quot;
              }
          }
          // btn.onclick=clickBtn; // 只写函数名，不写括号，因为加括号就会立即执行
</code></pre></li> <li><p>事件类型：</p> <ul><li><p>onload: window.onload=function() {} // unload</p></li> <li><p>onchange:域的内容发生改变时发生(select) // 当菜单里的内容发生变化的时候执行脚本</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>selece</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>menu<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>#f00<span class="token punctuation">&quot;</span></span> <span class="token attr-name">selected</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>#ff0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>selece</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
	<span class="token comment">// 选中的option的值</span>
	menu<span class="token punctuation">.</span><span class="token function-variable function">onchange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token keyword">return</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">,</span> menu<span class="token punctuation">.</span>options<span class="token punctuation">[</span>menu<span class="token punctuation">.</span>selectedIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li> <li><p>onfoucs: 获得焦点时触发（input 等框）</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 获取表单元素的值</span>

input<span class="token punctuation">.</span><span class="token function-variable function">onblur</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>
	tip<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">'&lt;img src=&quot;img/right.png&quot;&gt;'</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>onblur：失去焦点时触发（input 等框）</p></li> <li><p>onsubmit: 表单中的确认按钮被点击 <em>不是加在按钮上的而是加在表单上的</em></p></li> <li><p>onmousedown：鼠标在元素上按下的时候</p></li> <li><p>onmousemove：鼠标指针移动时</p></li> <li><p>onmouseup：在元素上松开按钮的时候</p></li> <li><p>onresize：调整浏览器窗口大小. 经常作用在 window 上，但也可以作用在元素上<code>window.onresize = function() {}</code></p></li> <li><p>onscroll：拖动滚动条 <code>window.onscroll = function() { // overflow: auto }</code></p></li></ul></li> <li><p>键盘事件</p> <ul><li>onkeydown: 按下一个键时</li> <li>onkeypress: 释放一个键时</li> <li>onkeyup: 按键被松开时</li> <li>顺序：down - press - up</li> <li>event 对象 keyCode 这个属性：返回键盘事件触发的值的字符代码或键的代码</li> <li>event：事件对象，事件的状态，如触发 event 对象的元素，鼠标的位置及状态等</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 字符串也有长度</span>

document<span class="token punctuation">.</span><span class="token function-variable function">onkeydown</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>enent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>keyCode<span class="token punctuation">)</span>
	<span class="token keyword">const</span> len <span class="token operator">=</span> text<span class="token punctuation">.</span>value<span class="token punctuation">.</span>length
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li></ul> <h2 id="bom"><a href="#bom" aria-hidden="true" class="header-anchor">#</a> BOM</h2> <ul><li><p>浏览器对象模型：提供访问浏览器的功能</p></li> <li><p>window:浏览器的一个实例，它既是通过 js 访问浏览器窗口的一个接口，又是 ECMAScript 规定的 global 对象，window 可以省略（window.name === name）。</p> <ul><li><p>window 的方法：</p> <div class="language-js extra-class"><pre class="language-js"><code>    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'XXXXXXX'</span><span class="token punctuation">)</span>
    <span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">&quot;XXX&quot;</span><span class="token punctuation">)</span>
        <span class="token comment">// 返回值是个Boolean值，需要接收 const tmp = window.confirm('提示信息')。tmp 就是true或者false</span>

    <span class="token function">prompt</span><span class="token punctuation">(</span><span class="token string">&quot;text, defaultText&quot;</span><span class="token punctuation">)</span>
        <span class="token comment">// text:要在对话框中显示的纯文本;defaultText：默认的输入文本;</span>

        <span class="token comment">// 返回值：点击取消按钮，返回null；点击确认按钮，返回当前显示的文本(默认或者输入？？)</span>
        <span class="token comment">// 例子：let message = prompt(&quot;请输入姓名&quot;, &quot;李月茹&quot;) console.log(message)</span>

    <span class="token function">open</span><span class="token punctuation">(</span>pageURL<span class="token punctuation">,</span>name<span class="token punctuation">,</span>parameters<span class="token punctuation">)</span>
        <span class="token comment">// 打开一个新的浏览器窗口或查找一个已命名的窗口</span>
        <span class="token comment">// pageURL： 子窗口路径</span>
        <span class="token comment">// name: 子窗口句柄（name声明了新窗口的名字，方便通过name对子窗口进行引用）</span>
        <span class="token comment">// parameters：窗口参数，各个参数用逗号分隔</span>
        <span class="token comment">// 在一个页面里打开另一个页面（窗口）</span>

    window<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'newwindow.html'</span><span class="token punctuation">,</span> <span class="token string">'newname'</span><span class="token punctuation">,</span> <span class="token string">&quot;width=400, height=00, left=0, top=0, toolbar = no, menubar = no, scrollbars=no, location=no, status=no&quot;</span><span class="token punctuation">)</span>
        <span class="token comment">// newwindow.html页面与写代码的页面在同一目录,默认打开一个标签页，默认的</span>
        <span class="token comment">// 可以设置的参数有：</span>
            width<span class="token punctuation">:</span> 窗口宽度<span class="token punctuation">,</span>
            height<span class="token punctuation">:</span> 窗口高度<span class="token punctuation">,</span>
            left<span class="token punctuation">:</span> 窗口<span class="token constant">X</span>轴坐标<span class="token punctuation">,</span>
            top<span class="token punctuation">:</span> 窗口<span class="token constant">Y</span>轴坐标<span class="token punctuation">,</span>
            toolbar<span class="token punctuation">:</span> 是否显示浏览器工具栏<span class="token punctuation">,</span>
            menubar<span class="token punctuation">:</span> 是否显示菜单栏<span class="token punctuation">,</span>
            scrollbars<span class="token punctuation">:</span> 是否显示滚动条<span class="token punctuation">,</span>
            location<span class="token punctuation">:</span> 是否显示地址字段<span class="token punctuation">,</span>
            status<span class="token punctuation">:</span> 是否显示状态栏

    <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// 关闭子窗口的。关闭当前窗口，能不能关闭子窗口？？？</span>

    window<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 关闭当前窗口</span>

    <span class="token function">setTimeout</span><span class="token punctuation">(</span>code<span class="token punctuation">,</span> millisec<span class="token punctuation">)</span>
        <span class="token comment">// 超时调用</span>
            code<span class="token punctuation">:</span> 要调用的函数或要执行的代码
            millisec<span class="token punctuation">:</span> 在执行代码前需要等待的毫秒数
        <span class="token comment">// 返回值：返回一个ID值，通过它取消超时调用</span>

    <span class="token keyword">const</span> timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token string">&quot;alert('aaa')&quot;</span><span class="token punctuation">,</span> <span class="token number">4000</span><span class="token punctuation">)</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;aaa&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
    <span class="token function">clearTimeout</span><span class="token punctuation">(</span>id_of_settimeout<span class="token punctuation">)</span>
    <span class="token comment">// 清除超时调用。id_of_settimeout：setTimeout()返回的ID值</span>

    <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span>
    <span class="token function">setInterval</span><span class="token punctuation">(</span>code<span class="token punctuation">,</span> millisec<span class="token punctuation">)</span>
    <span class="token comment">// 间歇调用。millisec: 周期性执行或调用code之间的时间间隔</span>

    <span class="token keyword">const</span> intervalId <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1111</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">clearInterval</span><span class="token punctuation">(</span>intervalId<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span>
    timer <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token comment">// null 释放内存</span>
</code></pre></div></li></ul></li> <li><p>navigator</p> <ul><li>navigator 对象: 当前浏览器和操作系统的信息</li> <li>userAgent 属性：识别浏览器名称，版本，引擎，以及操作系统等信息的内容
// console.log(navigator.userAgent) // msie,chrome,opera,safari</li></ul></li> <li><p>screen</p> <ul><li>screen 对象：客户端显示屏幕的信息</li> <li>screen.availWidth // 返回可用的屏幕宽度</li> <li>screen.availHeight // 返回可用的屏幕高度</li> <li>window.innerWidth // 窗口的宽高</li> <li>window.innerHeight</li></ul></li> <li><p>history</p> <ul><li>history 对象：ie8 以上哈希也会生成一条历史记录</li> <li>方法：
<ul><li>history.back() // 回到历史记录的上一步，相当于 history.go(-1)</li> <li>history.forward() // history.go(1)</li></ul></li></ul></li> <li><p>location</p> <ul><li>location 对象：提供了与当前窗口中加载的文档相关的内容，还提供了一些导航的功能，他既是 window 对象的属性，也是 document 对象的属性</li> <li>属性：
<ul><li>location.href // 返回当前加载页面的完整的 URL
// console.log(location.href)</li> <li>location.hash // 返回 URL 中的哈希，#号后的 0 或多个字符，不包含返回空字符串<div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- console.log(location.hash)
    哈希就是锚点链接
    回到顶部 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>top<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
btn.onclick=() =&gt; { location.hash = '#top' }
</code></pre></div></li> <li>location.host // 返回服务器名称和端口号</li> <li>location.hostname // 不带端口号的服务器名称</li> <li>location.pathname // 返回 URL 中的目录或文件名</li> <li>location.port // 返回 URL 中指定的端口号</li> <li>location.protocol // 返回页面使用的协议</li> <li>location.search // 返回 URL 的查询字符串，这个字符串以问号开头，无为空</li></ul></li> <li>方法：
<ul><li>location.href = index.html // 会生成历史记录</li> <li>location.replace(url) // 重新定向 URL，不会在历史记录中生成新纪录</li> <li>location.replace('index.html')</li> <li>location.reload() // 重新加载页面。可能是从缓存中加载的</li> <li>location.reload(true) // 重新加载页面。从服务器端重新加载</li></ul></li></ul></li> <li><p>document</p></li> <li><p>event</p></li></ul> <h2 id="轮播图小技巧"><a href="#轮播图小技巧" aria-hidden="true" class="header-anchor">#</a> 轮播图小技巧</h2> <ol><li><p>图片重叠在一起，默认都不显示，加一个 active 的类表示显示，用 js 改变 active 加在哪张图片上</p></li> <li><p>定位时，如果有 left，则再有 right 时，left 先起作用。若想让 right 起作用，让 left: auto</p></li> <li><p>如果有背景图片，再设 background: #fff; 这时会把图片覆盖，这时要用 background-color: #fff;</p></li></ol> <h2 id="正则表达式"><a href="#正则表达式" aria-hidden="true" class="header-anchor">#</a> 正则表达式</h2> <p>有两种字符: 字符+元字符
元字符(特殊字符): <code>* + ? \$ ^ . | \ () {} []</code>
\t: 水平制表符
\v: 垂直制表符
\n: 换行符
\r: 回车符
\0: 空字符
\f: 换页符
\cX: 与 X 对应的控制字符（ctrl + X）</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/*
匹配字符串的规则
*/</span>
<span class="token comment">// 类，[abc]</span>
<span class="token punctuation">[</span>abc<span class="token punctuation">]</span><span class="token punctuation">:</span> abc中的一个
<span class="token comment">// 类取反 [^abc]</span>
<span class="token punctuation">[</span><span class="token operator">^</span>abc<span class="token punctuation">]</span><span class="token punctuation">:</span> 不是字符abc的内容
<span class="token comment">// 范围类[a-z]</span>
<span class="token punctuation">[</span>a<span class="token operator">-</span>z<span class="token punctuation">]</span><span class="token punctuation">:</span> 从a到z的任意字符
<span class="token punctuation">[</span>a<span class="token operator">-</span>zA<span class="token operator">-</span><span class="token constant">Z</span><span class="token punctuation">]</span><span class="token punctuation">:</span> a<span class="token operator">-</span>z<span class="token punctuation">,</span><span class="token constant">A</span><span class="token operator">-</span><span class="token constant">Z</span>
<span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">9</span><span class="token operator">-</span><span class="token punctuation">]</span><span class="token punctuation">:</span> 从<span class="token number">0</span><span class="token operator">-</span><span class="token number">9</span>和字符<span class="token operator">-</span>
<span class="token comment">// 预定义类</span>
<span class="token punctuation">.</span> <span class="token punctuation">:</span> 除了回车换行之外的所有字符 <span class="token punctuation">[</span><span class="token operator">^</span><span class="token operator">/</span>r<span class="token operator">/</span>n<span class="token punctuation">]</span>
\d<span class="token punctuation">:</span> 数字字符<span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">]</span>
\<span class="token constant">D</span><span class="token punctuation">:</span> 非数字字符<span class="token punctuation">[</span><span class="token operator">^</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">]</span>
\s<span class="token punctuation">:</span> 空白符<span class="token punctuation">[</span>\t\n\x0B\f\r<span class="token punctuation">]</span>
\<span class="token constant">S</span><span class="token punctuation">:</span> 非空白符<span class="token punctuation">[</span><span class="token operator">^</span>\t\n\x0B\f\r<span class="token punctuation">]</span>
\w<span class="token punctuation">:</span> 单词字符（字母数字下划线）<span class="token punctuation">[</span>a<span class="token operator">-</span>zA<span class="token operator">-</span><span class="token constant">Z_0</span><span class="token operator">-</span><span class="token number">0</span><span class="token punctuation">]</span>
\<span class="token constant">W</span><span class="token punctuation">:</span> 非单词字符<span class="token punctuation">[</span><span class="token operator">^</span>a<span class="token operator">-</span>zA<span class="token operator">-</span><span class="token constant">Z_0</span><span class="token operator">-</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token comment">// 边界</span>
<span class="token operator">^</span><span class="token punctuation">:</span> 开头
$<span class="token punctuation">:</span> 结尾
\b<span class="token punctuation">:</span> 单词边界
\<span class="token constant">B</span><span class="token punctuation">:</span> 非单词边界
<span class="token comment">// 量词, {}</span>
<span class="token operator">?</span><span class="token punctuation">:</span> 出现<span class="token number">0</span>次或者一次，最多一次
<span class="token operator">+</span><span class="token punctuation">:</span> 出现<span class="token number">1</span>次或者多次，最少一次
<span class="token operator">*</span><span class="token punctuation">:</span> 出现<span class="token number">0</span>次或者多次，任意次
<span class="token punctuation">{</span>n<span class="token punctuation">}</span><span class="token punctuation">:</span> 出现n次
<span class="token punctuation">{</span>n<span class="token punctuation">,</span>m<span class="token punctuation">}</span><span class="token punctuation">:</span> 出现n到m次
<span class="token punctuation">{</span>n<span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">:</span> 至少出现n次
<span class="token comment">// 贪婪模式: 尽可能多的匹配</span>
<span class="token string">'12345678'</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\d{3-6}/g</span><span class="token punctuation">,</span> <span class="token string">'X'</span><span class="token punctuation">)</span> <span class="token comment">// X78, 会匹配最大的次数</span>
<span class="token comment">// 非贪婪模式：一旦匹配成功就不再继续，只要在量词后面加上?即可</span>
<span class="token string">'12345678'</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\d{3-6}?/g</span><span class="token punctuation">,</span> <span class="token string">'X'</span><span class="token punctuation">)</span> <span class="token comment">// XX78, 一旦匹配成功就不再继续 123-&gt;X 456-&gt;X</span>
<span class="token string">'123456789'</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/\d{3-5}?/g</span><span class="token punctuation">)</span><span class="token comment">// [&quot;123&quot;, '456', '789']</span>
<span class="token comment">// 分组(): 使量词作用于分组,而不是一个字符; 或 |作用于分组;反向引用 $1可以拿到组匹配到的内容; 忽略分组，在分组内加上?:即可</span>
<span class="token string">'a1b2c3d4'</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/([a-z]\d){3}/g</span><span class="token punctuation">,</span> <span class="token string">&quot;X&quot;</span><span class="token punctuation">)</span> <span class="token comment">// Xd4, 匹配一个字母加一个数字连续出现3次的情况</span>
<span class="token string">'2015-02-23'</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/(\d{4})-(\d{2})-(\d{2})/g</span><span class="token punctuation">,</span> <span class="token string">'$1$2$3'</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token operator">?</span><span class="token punctuation">:</span>Byron<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">(</span>ok<span class="token punctuation">)</span>
<span class="token comment">// 前瞻(?=)(?!), 断言, js不支持后顾</span>
正则表达式是从文本 头<span class="token operator">-</span><span class="token operator">&gt;</span>尾，文本尾部方向成为<span class="token string">&quot;前&quot;</span>
匹配到一个人叫张三的时候，还得判断他爸爸是不是叫张二
断言要匹配，但是不会被替换
<span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">=</span>assert<span class="token punctuation">)</span>
<span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">!</span>assert<span class="token punctuation">)</span>
\<span class="token function">w</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">=</span>\d<span class="token punctuation">)</span> <span class="token comment">//匹配是不是文字, 且该文字后面是数字</span>
<span class="token comment">// 正则对象的属性,方法</span>
<span class="token comment">// 属性</span>
global<span class="token punctuation">:</span> 是否全文搜索，默认<span class="token boolean">false</span>
ignore <span class="token keyword">case</span><span class="token punctuation">:</span> 是否大小写敏感，默认<span class="token boolean">false</span>
multiline<span class="token punctuation">:</span> 多行搜索，默认<span class="token boolean">false</span>
lastIndex<span class="token punctuation">:</span> 这一轮匹配完了，下一轮的开始位置。在非全局情况下lastindex不生效
sourch<span class="token punctuation">:</span> 正则表达式

<span class="token keyword">const</span> reg <span class="token operator">=</span> <span class="token regex">/\w/gim</span><span class="token punctuation">;</span>
reg<span class="token punctuation">.</span>global <span class="token comment">// true</span>
reg<span class="token punctuation">.</span>ignoreCase <span class="token comment">// true</span>
reg<span class="token punctuation">.</span>multiline <span class="token comment">// true</span>
reg<span class="token punctuation">.</span>lastIndex <span class="token comment">// true</span>
reg<span class="token punctuation">.</span>sourch <span class="token comment">// &quot;\w&quot;</span>
<span class="token comment">// 方法</span>
RegExp<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'dkfsdkfsd'</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'$'</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
RegExp<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token comment">// 没有匹配到返回null,否则返回一个结果数组</span>

<span class="token comment">// 字符串对象的正则方法</span>
String<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>reg<span class="token punctuation">)</span> <span class="token comment">// 忽略全局搜索，index或者-1</span>
<span class="token string">'dfdsfsd'</span><span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span><span class="token string">'d'</span><span class="token punctuation">)</span>
String<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>reg<span class="token punctuation">)</span><span class="token comment">// 数组</span>
String<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span>reg<span class="token punctuation">)</span> <span class="token comment">// 数组</span>
String<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>reg<span class="token punctuation">,</span> <span class="token string">'替换成谁'</span><span class="token punctuation">)</span> <span class="token comment">// 数组， '替换成谁'可以是function(匹配结果,group1 ...groupx ,index,原字符串)</span>

<span class="token comment">/*
IDE 中规则复杂的字符串查找替换
*/</span>
<span class="token comment">// 匹配 单词is，\b是单词边界</span>
\bis\b
<span class="token comment">// http://aaa/bbb/ccc.jpg 去掉所有jpg文件的协议头。 .+任意字符至少一次, 小括号是分组, 用$1可以获取匹配到的内容</span>
http<span class="token punctuation">:</span><span class="token punctuation">(</span>\<span class="token operator">/</span>\<span class="token operator">/</span><span class="token punctuation">.</span><span class="token operator">+</span>\<span class="token punctuation">.</span>jps<span class="token punctuation">)</span>
$<span class="token number">1</span>
<span class="token comment">// 日期替换： \d数字，{4}重复次数，[-/]或者, ^开头，$结尾, ()分组</span>
<span class="token operator">^</span><span class="token punctuation">(</span>\d<span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">/</span><span class="token operator">-</span><span class="token punctuation">]</span><span class="token punctuation">(</span>\d<span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">/</span><span class="token operator">-</span><span class="token punctuation">]</span><span class="token punctuation">(</span>\d<span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span>$
$<span class="token number">1</span><span class="token operator">-</span>$<span class="token number">2</span><span class="token operator">-</span>$<span class="token number">3</span>

<span class="token comment">/*
js 正则处理字符串

js中通过内置对象RegExp支持正则表达式

有两种方法实例化RegExp对象
字面量: const reg = /\bis\b/g;
构造函数: const reg = new RegExp('\\bis\\b', 'g')
修饰符: g全文搜索, i忽略大小写, m多行搜索（有换行符默认第二行开头也不会匹配,加上m会被匹配）
字符串:  'my name is lyr'.replace(reg, &quot;要替换成的字符串&quot;);
*/</span>
</code></pre></div><h2 id="js事件循环，宏微任务"><a href="#js事件循环，宏微任务" aria-hidden="true" class="header-anchor">#</a> js事件循环，宏微任务</h2> <p>异步执行顺序的差异: 要明白这个问题需要去了解js的事件循环模型 (js的执行栈，作用域链，变量提升，js的单线程原因)
关键字：marcotask microtask queue 执行上下文context 堆heap 栈stack 作用域</p> <p>宏任务: setTimeout，setTimeInterval, setTimeout在0ms后将callback加入到宏任务的queue中
微任务: promise.then中的回调, promise的回调放在微任务的queue中</p> <p>先去微任务的queue，再去执行宏任务队列中的callback。</p> <h2 id="js事件轮询event-loop"><a href="#js事件轮询event-loop" aria-hidden="true" class="header-anchor">#</a> js事件轮询event loop</h2> <p>一个进程由一个或多个线程组成，线程是一个进程中代码的不同执行路线
一个进程的内存空间是共享的，每个线程都可用这些共享内存。但进程之间是独立的。
多进程: 在同一个时间里，同一个计算机系统中允许两个或两个以上的进程处于运行状态。
多线程：程序中包含多个执行流。一个程序中可以同时运行多个不同的线程来执行不同的任务。
以Chrome浏览器中为例，当你打开一个 Tab 页时，其实就是创建了一个进程，一个进程中可以有多个线程，如渲染线程、JS 引擎线程、HTTP 请求线程等等。
当你发起一个请求时，其实就是创建了一个线程，当请求结束后，该线程可能就会被销毁。</p> <p>浏览器主要由4个进程组成</p> <ol><li>browser主进程: 就是浏览器的主进程,一般只有一个,用于管理,协调,调配,前进后退一些大的功能。负责各个页面的管理，创建和销毁其他进程。将Renderer进程得到的内存中的Bitmap，绘制到用户界面上。网络资源的管理，下载等。</li> <li>GPU渲染进程: 最多一个，主要用于渲染一些3d动画</li> <li>第三方插件进程: 每种类型的插件对应一个进程，仅当使用该插件时才创建</li> <li>浏览器渲染进程: 这个对于前端来说比较重要,每个tab都是拥有一个进程,每个tab互不干扰。页面渲染，脚本执行，事件处理等，在浏览器中打开一个网页相当于新起了一个进程（进程内有自己的多线程）。</li></ol> <p>浏览器渲染进程（浏览器内核，也被称为渲染引擎）
多线程，5个线程
对于异步，如果有回调函数，才会异步执行。
GUI渲染线程与JS引擎线程是互斥的</p> <ol><li>GUI线程: 负责渲染浏览器界面，解析HTML，CSS，构建DOM树和RenderObject树，布局和绘制等。当界面需要重绘（Repaint）或由于某种操作引发回流(reflow)时该线程就会执行。GUI线程的js线程会互斥,也就是js线程跑的时候,GUI线程就不会跑,反之亦然</li> <li>网络请求线程: 主要处理一些http异步请求,接受到请求之后会把回调函数交给事件队列线程,然后再给js线程去执行代码</li> <li>定时器线程: setTimeOut和setInterVal,主线程依次执行代码时遇到定时器，会将定时器交给该线程处理，当计数完毕后，事件触发线程会将计数完毕后的事件加入到任务队列的尾部，等待JS引擎线程执行。</li> <li>js解析线程: 解析js的脚本程序, 也主要处理异步回调。每个tab都拥有独立的js解析线程</li> <li>事件触发线程: 主要就是存放一些,异步的回调事件,当达成某个条件后,就会触发回调函数,推入事件触发线程,事件触发线程会根据js解析线程是否空闲去推到js解析线程上解析代码。</li></ol> <p>宏任务(macrotask): setTimeout、setInterval、script（整体代码块）、 I/O 操作、UI 渲染等, 宏任务是放到事件触发队列里面的。
微任务(microtask): Promise，process.nextTick, MutationObserver(html5新特性)等, 是放到微任务队列里面的,由js线程掌管。微任务在es6里面被规范为jobs queue</p> <p>js在执行宏任务前先会把微任务执行完清空,执行完一个宏任务去清空一次微任务
流程如下：</p> <ol><li>js解析线程先执行完栈内的代码</li> <li>在执行事件触发线程里面的宏任务之前,先会看看微任务队列里面是否有微任务,有就会先一步调用所有的微任务</li> <li>调用完微任务再触发一个宏任务</li> <li>执行完一个宏任务会再去找微任务</li></ol> <p>这也是为什么setTimeOut和setInterVal有时会不准确,如果js解析线程还没解析完栈内的代码,就不能执行定时器的回调了,即使是定时器的时间到了,也没办法</p> <p>执行过程</p> <ol><li>执行一个宏任务并将之出队（主程序也是一个宏任务）</li> <li>执行一对微任务并将之出队</li> <li>执行渲染操作，更新界面</li> <li>处理worker相关的任务
当某个宏任务执行完后,会查看是否有微任务队列。
如果有，先执行微任务队列中的所有任务，如果没有，会读取宏任务队列中排在最前的任务，执行宏任务的过程中，遇到微任务，依次加入微任务队列。
栈空后，再次读取微任务队列里的任务，依次类推。</li></ol> <p>总结就是：每一次宏任务执行完之后就会执行自己的微任务队列</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 例1:</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        i <span class="token operator">==</span> <span class="token number">9</span> <span class="token operator">&amp;&amp;</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token comment">// 结果: 2，3，5，4，1</span>
<span class="token comment">// promise的定义是同步的，then是异步的</span>
<span class="token comment">// 例2:</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 结果: 1,5,3,4,2</span>

<span class="token comment">// 例3:</span>
Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span> <span class="token comment">// promise1</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise1'</span><span class="token punctuation">)</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span> <span class="token comment">// setTimeout1</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'setTimeout1'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span> <span class="token comment">// setTimeout2</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'setTimeout2'</span><span class="token punctuation">)</span>
  Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span> <span class="token comment">// promise2</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise2'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token comment">// 结果：promise1,setTimeout2,promise2,setTimeout1</span>
</code></pre></div><p>分析:
第一轮：执行宏任务（主函数） --&gt; 清空微任务队列
执行同步：主函数执行完毕，没有同步代码，生成一个微任务promise1, 一个宏任务setTimeout2。 // 微: [promise1]; 宏: [setTimeout2]
清空微任务队列：执行微任务promise1: 打印promise1并且生成一个宏任务setTimeout1。 // 微: []; 宏: [setTimeout2, setTimeout1]
第二轮：执行下一个宏任务（setTimeout2）--&gt; 清空微任务队列
执行同步: 执行setTimeout2：打印setTimeout2并且生成一个微任务promise2 // 微: [promise2]; 宏: [setTimeout1]
清空微任务队列: 执行promise2：打印promise2 // 微: []; 宏: [setTimeout1]
第三轮：执行下一个宏任务（setTimeout1）--&gt; 清空微任务队列
执行同步：执行setTimeout1：打印setTimeout1 // 微: []; 宏: []
清空微任务队列: 无任务</p> <h2 id="浏览器的基本工作原理"><a href="#浏览器的基本工作原理" aria-hidden="true" class="header-anchor">#</a> 浏览器的基本工作原理</h2> <p>核心问题：在地址栏输入 google.com 直到您在浏览器屏幕上看到 Google 首页的整个过程中都发生了些什么
WebKit 是一种开放源代码 rendering engine, 也叫内核。Safari 和 Chrome 浏览器使用的都是 WebKit。</p> <ol><li>什么是引擎？
如果把游戏中所有的对象看作状态机，游戏引擎就是改变状态的规则，它定义了对象（状态机）在什么情况下应该转变为另一种状态并且完成这个状态的转换。
汽车，开始是静止状态。引擎，定义了当打火的时候汽车发动，当踩油门的时候，引擎会让汽车进行加速。
引擎是改变状态的动力，它定义了状态如何改变并且将这种改变实现。</li></ol> <p>从状态的角度讲，引擎是为了实现状态的转换。而状态的转换，需要定义规则。即在什么情况下作出什么反应。
从功能的角度讲，引擎是封装了代码/函数库，通过调用代码/函数库的接口来实现特定的功能。
从抽象的角度讲，引擎简化了我们看问题的视角。使得我们通过引擎就可以对程序的功能状态进行改变，从而实现丰富的内容和功能。</p> <ol start="2"><li>BFC
块格式化上下文（Block Formatting Context，BFC）
是块盒子的布局过程发生的区域，也是浮动元素与其他元素交互的区域。</li></ol> <p>下列方式会创建块格式化上下文:</p></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/blogs/grammar/less.html" class="prev">
          less
        </a></span> <span class="next"><a href="/blogs/grammar/es6.html">
          ES6
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/blogs/assets/js/11.687313e6.js" defer></script><script src="/blogs/assets/js/app.2b612f2a.js" defer></script>
  </body>
</html>
